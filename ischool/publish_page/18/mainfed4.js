var accessToken="";(function(b){b.fn.widget=function(a,c){return this.each(function(){var d=jQuery(this).attr("id"),e=String(jQuery(this).attr("class")).split(" ")[0],j=b(this);if(jQuery(this).is(":visible")&&e.indexOf("WID")!=-1){var f=e.split("_");if(f.length==4&&(f=parseInt(f[1]),!isNaN(f))){var g=b.fn.widget[d];b.isFunction(g)?g(j,a,f,e,c):(a.complete!=null&&a.complete(e),log("Not implement widget: "+d))}}})}})(jQuery);function get_api_url(b){return g_api_url+b}
function generate_nav_bar(b,a){var c="";c+='<div class="navDiv">';b>0?(c+='<a class="nav-load-x" data-page="0">|&lt;</a>',c+='<a class="nav-load-x" data-page="'+(b-1)+'">&lt;&lt;</a>'):c+='<span class="disable">|&lt;</span><span class="disable">&lt;&lt;</span>';for(var d=!1,e=0;e<a;e++)e==b?(c+='<span class="select">'+(e+1)+"</span>",d=!1):Math.abs(e-b)>2&&e!=a-1&&e!=0&&a>10?d==!1&&(c+="<span>...</span>",d=!0):c+='<a class="nav-load-x" data-page="'+e+'">'+(e+1)+"</a>";b<a-1?(c+='<a class="nav-load-x" data-page="'+
(b+1)+'">&gt;&gt;</a>',c+='<a class="nav-load-x" data-page="'+(a-1)+'">&gt;|</a>'):c+='<span class="disable">&gt;&gt;</span><span class="disable">&gt;&gt;|</span>';c+="</div>";return c}
(function(b){b.fn.widget.header=function(a,c,d,e){a.resize(function(){var a=parseInt(b(this).find("#header_pic").attr("data-widget-height"));b(this).attr("class");var c=parseInt(b(this).find("#header_pic").attr("data-image-width")),e=c,d=a;b(this).width()<c&&g_rwd==1?(e=b(this).width(),d=e*(a/c),b(this).find("#header_pic").css("background-size",e),b(this).css("height",d)):(b(this).find("#header_pic").css("background-size","auto"),b(this).css("height",a))});c.complete!=null&&c.complete(e)};b.fn.widget.carousel=
function(a,c,d,e){var j=c.root_path,f=a.find(".pics").attr("data-widget-width"),g=a.find(".pics").attr("data-widget-height"),f=parseInt(a.find(".pics").attr("data-auto-adj-with-screen")),m=parseInt(a.find(".pics").attr("data-auto-browse")),h=g/2,d="uid="+e,n=function(a,c,e,d,h){var g=c="",f="";d==1||d==3?(c="."+a+" #prev1",g="."+a+" #next1"):d==2&&(f="."+a+" #nav");b("."+a+" .pics").cycle({fx:e,speed:1E3,delay:1E3,before:function(c,e){m!=0&&e!=void 0&&(b("."+a+" #"+e.id).css("left","0px"),b("."+a+
" #"+e.id).css("top","0px"))},after:function(c,e){if(m!=0&&e!=void 0){var d=e.cycleW,g=e.cycleH,F=b("."+a).width(),k=b("."+a).height();g>k&&(g=k-g,b("."+a+" #"+e.id).animate({top:g},h));d>F&&(g=F-d,b("."+a+" #"+e.id).animate({left:g},h))}},prev:c,next:g,pager:f,timeout:h,skipInitializationCallbacks:!0})},r=1;f==1&&(f=screen.width-17,is_rwd_page()&&(g=h),r=parseFloat(g/f));b.ajax({url:j+"widget/carousel/news_query_json_field.php",data:d,type:"POST",dataType:"json",timeout:2E4,error:function(){alert("Error loading carousel json data")},
success:function(d){for(var f=a.width(),y=Math.min(f*r,g),t=0,D=d[0].effect,A=d[0].navtype,C=d[0].playinterval,z=!!parseInt(d[0].autofit),l=1;l<d.length;l++){var u=d[l].image,p=j+"resources/"+e+"/"+u,F=d[l].title,k=d[l].link_to,i=!!parseInt(d[l].showtitle),v=!!parseInt(d[l].enablelink),B=d[l].target,E=parseInt(d[l].img_width),G=parseInt(d[l].img_height),w='<div id="slide_'+t+'" class="inner"';w+=' style="width:'+f+"px;height:"+y+'px"';w+=' data-image-width="'+E+'" data-image-height="'+G+'">';v&&(w+=
'<a href="'+k+'" target="'+B+'">');w+='<img src="'+p+'"';i&&(w+=' title="'+F+'"');w+=' alt="'+(F!=""?F:u)+'"';w+=' border="0">';w+='<div class="image-mask">';w+="</div>";i&&(w+='<div class="b-link">',w+='<div class="b-title">'+F+"</div>",w+="</div>");v&&(w+="</a>");w+="</div>";b("."+e+" .pics").append(w);t++}n(e,z,D,A,C);a.resize(function(){var a=b(this),c=b(this).width(),k=Math.min(Math.max(c*r,h),g),E=-1;b(this).find(".inner").each(function(){var a=b(this).attr("data-image-width"),e=b(this).attr("data-image-height"),
d=a,G=e;z?(d=c,G=d*(e/a)):(G=k,d=G*(a/e));b(this).css("width",z?d:c);b(this).css("height",G);a=c>d?(c-d)/2:0;b(this).find("img").css("left",a);b(this).find("img").css("width",d);b(this).find("img").css("height",G);m==0&&b(this).find(".b-link").css("bottom",G-k);E=Math.max(E,G)});E!=-1&&a.css("height",Math.min(k,E));b("."+e+" .pics").cycle("resize")});c.complete!=null&&c.complete(e)}});a.unbind("mouseover");a.mouseover(function(){a.find(".nav-arrow-type").animate({opacity:0.7},200)});a.unbind("mouseleave");
a.mouseleave(function(){a.find(".nav-arrow-type").animate({opacity:0.3},200)});a.find(".nav-arrow-type").animate({opacity:0.3},200)};b.fn.widget.main_menu=function(a,c,d,e){b("#site_embed_pages").height();var j=parseInt(a.find("#main_menu_x").attr("data-widget-depth")),d=parseInt(a.find("#main_menu_x").attr("data-widget-submenu-expand-mode")),f=function(){g_rwd!=0&&(is_rwd_page()?(a.find(".main-menu-content").hide(),a.find(".nav-trigger").show()):(a.find(".main-menu-content").show(),b(".nav-trigger").hide()))},
g=function(b){b.next("ul").length>0&&(a.find(".submenu").hide(),b.next().is(":visible")?b.html(b.html()).next().hide():b.html(b.html()).next().show(),adjustSectionSize())};j>1&&(d==0?a.find(".main_nav a").click(function(){g(b(this))}):(a.find(".main_nav a").mouseenter(function(){g(b(this))}),a.mouseleave(function(){a.find(".submenu").hide()})));f();a.find(".nav-trigger").unbind("click");a.find(".nav-trigger").click(function(){show_mobile_nav_bar(e)});a.find(".main_nav a").unbind("keydown");a.find(".main_nav a").keydown(function(a){if(a.keyCode==
9)return j>1&&g(b(this)),!0});a.resize(function(){f()});if(g_default_active_class_id>0){var m="C-"+g_default_active_class_id;a.find(".main_nav a").each(function(){var c=b(this);if(c.attr("id")==m)return a.find(".active").removeClass("active"),c.toggleClass("active"),!0;c.next("ul").find("a").each(function(){b(this).attr("id")==m&&(a.find(".submenu").hide(),c.next().is(":visible")?c.html(c.html()).next().hide():c.html(c.html()).next().show(),a.find(".active").removeClass("active"),b(this).toggleClass("active"))})})}c.complete!=
null&&c.complete(e)};b.fn.widget.main_menu2=function(a,c,d,e){var j=a.find("#main_menu_content2").attr("data-widget-mouseover-audio"),f=parseInt(a.find("#main_menu_content2").attr("data-widget-average-menu")),g=parseInt(a.find("ul.navigation>li a").css("width")),m=parseInt(a.find("#main_menu_content2").attr("data-widget-auto-flip-submenu")),h="",n=0,r=function(){var b=parseInt(a.find("ul.navigation > li > a").css("padding-left"))+parseInt(a.find("ul.navigation > li > a").css("padding-right"));navigator.userAgent.indexOf("Firefox")!==
-1&&(b=0);if(f==1){var c=parseInt(a.find("ul.navigation").css("padding-left"))*2,b=(a.width()-c)/a.find("ul.navigation>li").length-b;a.find("ul.navigation ul a").css("width",Math.max(b,200));a.find("ul.navigation>li>a").css("width",b);navigator.userAgent.indexOf("Firefox")!==-1&&a.find("ul.navigation>li>a").last().css("width",Math.floor(b))}else f!=2&&(b=g-b,a.find("ul.navigation ul a").css("width",Math.max(b,200)),a.find("ul.navigation>li>a").css("width",b),navigator.userAgent.indexOf("Firefox")!==
-1&&a.find("ul.navigation>li>a").last().css("width",Math.floor(b)));is_rwd_page()?(a.css("height","auto"),a.find(".main-menu-content").hide(),a.find(".nav-trigger").show()):(a.find(".main-menu-content").show(),a.find(".nav-trigger").hide(),a.find(".mobile-main-menu-content").hide())},x=function(){a.find("ul.navigation>li ul").hide()},s=function(a,b){var c=b.children("ul"),d=a.pageX,g=b.attr("data-level"),f=0,l=-1,u=-1;h=c.attr("id");typeof h!="undefined"&&(f=c.attr("data-ul-level"),l=c.width(),u=
l*f,log("sungmin: data_ul_level="+f+", "+(d+u)+", "+document.body.clientWidth));c.css("display","table");g>2&&(g=!1,f=c.parents("li[data-level=2]"),m==1&&(f.hasClass("flip-submenu-x")?g=!0:l>0&&d+u>document.body.clientWidth&&(g=!0,f.addClass("flip-submenu-x"))),g?c.css("left","-100%"):c.css("left","100%"),c.css("top","0"));j!=""&&createsoundbite(e+"/"+j).playclip()};a.find("ul.navigation > li:has(ul) > a").append("<div class='arrow-bottom'></div>");a.find("ul.navigation > li ul li:has(ul) > a").append("<div class='arrow-right'></div>");
a.find("ul.navigation").unbind("mouseleave");a.find("ul.navigation").mouseleave(function(){x(b(this));a.css("z-index",10)});a.find("ul.navigation li").unbind("mouseover");a.find("ul.navigation li").mouseover(function(c){s(c,b(this));a.css("z-index",99);a.find("ul").css("z-index",99)});a.find("ul.navigation li").unbind("mouseleave");a.find("ul.navigation li").mouseleave(function(){x(b(this));a.css("z-index",10);a.find("ul").css("z-index",10)});a.find("ul.navigation ul a").unbind("click");a.find("ul.navigation ul a").click(function(){b(this).find("ul.navigation li ul").hide()});
a.find("ul.navigation li a").unbind("click");a.find("ul.navigation li a").click(function(){a.find(".active").removeClass("active");b(this).closest(".navigation>li").children("a").toggleClass("active")});a.find("#close_mobile_main_menu_content2").unbind("click");a.find("#close_mobile_main_menu_content2").click(function(){show_mobile_nav_bar(e)});a.find(".nav-trigger").unbind("click");a.find(".nav-trigger").click(function(){show_mobile_nav_bar(e)});a.find("ul.navigation li").unbind("keyup");a.find("ul.navigation li").keyup(function(c){if(c.keyCode==
9){var e=b(this).parent("ul").attr("data-ul-level");e==1?x(b(this)):e<n&&a.find("ul[data-ul-level="+n+"]").hide();s(c,b(this));a.css("z-index",99);a.find("ul").css("z-index",10);log("key up on menu. currentULevel="+e+", prevULevel="+n);n=b(this).parent("ul").attr("data-ul-level");return!1}return!0});a.unbind("focusout");a.focusout(function(){});a.resize(function(){r()});a.find(".mobile-main-menu-content > li:has(ul) > a").append("<div class='mobile-arrow-bottom'></div>");a.find(".mobile-main-menu-content .mobile-arrow-bottom").unbind("click");
a.find(".mobile-main-menu-content .mobile-arrow-bottom").click(function(){$el=b(this).parents("li").find("ul");$el.css("display")!=="none"?$el.hide():$el.show();return!1});g_default_active_class_id!=""&&a.find("#C-"+g_default_active_class_id).toggleClass("active");r();c.complete!=null&&c.complete(e)};b.fn.widget.quick_link=function(a,c,d,e){var j=c.root_path,f=parseInt(a.find("#quick_link_main").attr("data-widget-size-type")),g=parseInt(a.find("#quick_link_main").attr("data-widget-nav-type"));parseInt(a.find("#quick_link_main").attr("data-widget-enable-carousel"));
var m=parseInt(a.find("#quick_link_main").attr("data-widget-show-count")),h=parseInt(a.find("#quick_link_main").attr("data-widget-play-interval")),n=parseInt(a.find("#quick_link_main").attr("data-image-show-width")),r=parseInt(a.find("#quick_link_main").attr("data-image-show-height")),x=parseInt(a.find("#quick_link_main").attr("data-margin-size")),s=decodeURIComponent(a.find("#quick_link_main").attr("data-string-table")),y=null,t=a.find("#quick_link_main").css("max-width"),D=!1,A=function(a,b){var c=
"";c+='<div class="navDivGF">';a>0?(c+='<a class="nav-load-x" data-page="0">|&lt;</a>',c+='<a class="nav-load-x" data-page="'+(a-1)+'">&lt;&lt;</a>'):c+='<span class="disable">|&lt;</span><span class="disable">&lt;&lt;</span>';for(var e=!1,d=0;d<b;d++)d==a?(c+='<span class="select">'+(d+1)+"</span>",e=!1):Math.abs(d-a)>2&&d!=b-1&&d!=0&&b>10?e==!1&&(c+="<span>...</span>",e=!0):c+='<a class="nav-load-x" data-page="'+d+'">'+(d+1)+"</a>";a<b-1?(c+='<a class="nav-load-x" data-page="'+(a+1)+'">&gt;&gt;</a>',
c+='<a class="nav-load-x" data-page="'+(b-1)+'">&gt;|</a>'):c+='<span class="disable">&gt;&gt;</span><span class="disable">&gt;&gt;|</span>';c+="</div>";return c},C=function(c){var d={};d.uid=e;d.maxRows=m;d.pageNum=c;d.w=n;d.h=r;b.ajax({url:j+"widget/quick_link/content_query_json_field.php",data:d,type:"POST",dataType:"json",timeout:2E4,error:function(){},success:function(c){var d=c[0].pageNum,l=c[0].totalPages;a.find(".adshow-x").hide();for(var k=1;k<c.length;k++){var i=c[k].resources,v=c[k].over_resources,
B="",E="",G=c[k].id,w=c[k].link_to,m=c[k].target,r=c[k].title,n=c[k].desc,E=c[k].style,x=c[k].over_style,I=c[k].display_alt_title;i!=""&&(B=j+"resources/"+e+"/"+i,a.find("#content_"+k+" img").attr("data-src",B));a.find("#content_"+k+" img").attr("src",B);a.find("#content_"+k+" img").attr("alt",I==1?r:"");I==1&&a.find("#content_"+k+" img").attr("title",r+"("+s+")");f==0?(a.find("#content_"+k+" img").attr("style",E),a.find("#content_"+k+" img").attr("data-style",E)):a.find("#content_"+k+" img").attr("style",
"");v!=""&&(E=j+"resources/"+e+"/"+v,a.find("#content_"+k+" img").attr("data-over-src",E));x!=""&&a.find("#content_"+k+" img").attr("data-over-style",x);a.find("#content_"+k+" a").attr("href",w);a.find("#content_"+k+" a").attr("target",m);a.find("#content_"+k+" a").attr("title",r+"("+s+")");a.find("#content_"+k+" h2").html(r);a.find("#content_"+k+" .ellipsis").text(n);a.find("#content_"+k+" .Txt").attr("id","q_"+G);a.find("#content_"+k).parent(".adshow-x").fadeIn()}g==2&&(a.find("#nav").empty(),a.find("#nav").append(A(d,
l)),a.find(".nav-load-x").click(function(){clearInterval(y);C(b(this).attr("data-page"))}));l>1?a.find("#nav").show():a.find("#nav").hide();h>0&&l>1&&(d+1>=l?d=0:d+=1,y=setTimeout(function(){C(d)},h));a.find(".adshow-x").mouseenter(function(){b(this).find("p").text()!=""&&b(this).find(".Txt").css("bottom",0);var a=b(this).find("img").attr("data-over-src");a!=""&&b(this).find("img").attr("src",a);a=b(this).find("img").attr("data-over-style");a!=""&&b(this).find("img").attr("style",a)});a.find(".adshow-x").mouseleave(function(){if(b(this).find("p").length>
0){var a=b(this).find(".Txt").height()-b(this).find(".Txt h2").height();b(this).find("p").text()==""&&(a=40);b(this).find(".Txt").css("bottom",-a)}var a=b(this).find("img").attr("data-over-src"),c=b(this).find("img").attr("data-src");a!=""&&c!=""&&b(this).find("img").attr("src",c);a=b(this).find("img").attr("data-over-style");c=b(this).find("img").attr("data-style");a!=""&&c!=""&&b(this).find("img").attr("style",c)})}})};a.resize(function(){var c=Math.round(window.devicePixelRatio*100)/100,d=b(this).width(),
g=0,h=0;log("quick_link "+e+": quick_link_max_width="+t);t.indexOf("%")!=-1?d*=parseInt(t)/100:d=t.indexOf("px")!=-1?parseInt(t):b(this).width();var m=0,k=0;a.find(".adshow-x").each(function(a){b(this).removeClass("first-col-x");var v=f==0?n:b(this).width(),B=b(this).css("border-left-style")=="none"?0:parseInt(b(this).css("border-left-width"));D=!1;log("quick_link "+e+": adshow_width="+v);v+=2*B+x;log("quick_link "+e+": adshow_margin_left="+x+", sum_adshow_width="+g+", quick_link_width="+d+", ratio="+
c);log("quick_link "+e+": adshow_width="+v);v>=d?is_rwd_page()?(log("quick_link "+e+": this is full case, adshow_width="+v+", quick_link_width="+d),b(this).css("width","auto"),D=!0):(v=d-2*B-x,v*=c,b(this).css("width",v)):b(this).css("width","auto");g+v<=d?(g+=v,a==0&&b(this).addClass("first-col-x"),m++):(m=0,g=v,b(this).addClass("first-col-x"),k++);k==0&&b(this).addClass("first-row-x");h=Math.max(g,h);b(this).find(".Txt").css("width",n);b(this).find(".Txt").each(function(){if(b(this).find("p").length>
0){var a=b(this).height()-b(this).find("h2").height();b(this).find("p").text()==""&&(a=40);b(this).css("bottom",-a)}})});D?(a.find("#quick_link_main").css("width","100%"),a.find("#quick_link_main").css("max-width","100%")):h>0&&(a.find("#quick_link_main").css("width",h),horzWidthOffset=a.find("#quick_link_main").get(0).scrollWidth-a.find("#quick_link_main").get(0).clientWidth,horzWidthOffset>0&&(h+=horzWidthOffset,a.find("#quick_link_main").css("width",h)));f==0&&(a.find(".adshow-x").css("margin-left",
x),a.find(".first-row-x").css("margin-top",0),a.find(".first-col-x").css("margin-left",0));a.find(".navDiv").css("margin-left",-a.find(".navDiv").width()/2)});C(0);c.complete!=null&&c.complete(e)};b.fn.widget.youtubexx=function(a,c,d,e){var j=a.find(".main").attr("data-show-title"),d=a.find(".main").attr("data-show-playlist"),f=a.find(".main").attr("data-show-playlist-height"),g=function(b){var c=b.getAttribute("data-src"),b=b.getAttribute("title");a.find("iframe").attr("src",c);j==1&&(a.find(".youtube_title_block span").attr("title",
b),a.find(".youtube_title_block span").text(b))},m=a.find("li").length;m>0&&(m=Math.floor(Math.random()*m),m=a.find("li").get(m),g(m));d==0?a.find(".playlist").hide():d==1?(a.find(".playlist").hide(),a.find(".main").mouseenter(function(){var c=a.find(".main .playlist");c.show();c.css("top",b(this).height())}),a.find(".main").mouseleave(function(){a.find(".main .playlist").hide()}),a.find(".main .playlist li").click(function(){g(b(this).get(0));a.find(".main .playlist").hide()})):(a.find(".playlist").show(),
a.find(".main .playlist").css("height",f),a.find(".main .playlist li").click(function(){g(b(this).get(0))}));(function(){var b=a.find(".header").height()+a.find(".yucontent").height()+a.find(".footer").height();setWidgetHeight(a,b)})();c.complete!=null&&c.complete(e)};b.fn.widget.youtube=function(a,c,d,e){var j=c.root_path,d=c.action,f=a.find(".main").attr("data-show-title"),g=a.find(".main").attr("data-autoplay"),m=a.find(".main").attr("data-controls"),h=a.find(".main").attr("data-mute"),n=a.find(".main").attr("data-autoplay-next-video"),
r=a.find(".main").attr("data-random-play"),x=a.find(".main").attr("data-show-playlist"),s=a.find(".main").attr("data-show-playlist-height"),y=null,t=!1,D="",A=-1,C=function(){var b=0,c=a.find("li").length;if(c<=1)return 0;if(r)for(;;){if(b=Math.floor(Math.random()*c),b!=A)break}else b=A+1,b>c&&(b=0);return b},z=function(a){var c={};c.youtubeId=a;b.ajax({url:j+"widget/youtube/update_youtube_clicks.php",data:c,type:"GET",dataType:"text",timeout:2E4,error:function(){},success:function(){}})},l=function(b){var c=
b.getAttribute("data-src"),d=b.getAttribute("title");A=b.getAttribute("data-id");D=b.getAttribute("data-end-url");y!=null&&c!=""&&t&&(y.loadVideoByUrl(c),h==1&&y.mute(),g==0&&y.stopVideo());f==1&&(a.find(".youtube_title_block span").attr("title",d),a.find(".youtube_title_block span").text(d))},u=function(){t=!0;if(a.find("li").length>0){var b=C(),b=a.find("li").get(b);l(b)}},p=function(b){b.data==YT.PlayerState.PLAYING?log("YT.PlayerState.PLAYING"):b.data==YT.PlayerState.ENDED?(log("YT.PlayerState.ENDED"),
n==1?t!=!1&&(b=C(),b=a.find("li").get(b),l(b)):D!=""&&popup_content("url","940px",D),z(A)):b.data==YT.PlayerState.PAUSED?log("YT.PlayerState.PAUSED"):b.data==YT.PlayerState.BUFFERING?log("YT.PlayerState.BUFFERING"):b.data==YT.PlayerState.CUED&&log("YT.PlayerState.CUED")},F=function(){};if((typeof YT=="undefined"?!1:!0)==!1)return c=document.createElement("script"),c.src="https://www.youtube.com/iframe_api",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(c,e),this;x==0?a.find(".playlist").hide():
x==1?(a.find(".playlist").hide(),a.find(".main").mouseenter(function(){var c=a.find(".main .playlist");c.show();c.css("top",b(this).height())}),a.find(".main").mouseleave(function(){a.find(".main .playlist").hide()}),a.find(".main .playlist li").click(function(){l(b(this).get(0));a.find(".main .playlist").hide()})):(a.find(".playlist").show(),a.find(".main .playlist").css("height",s),a.find(".main .playlist li").click(function(){l(b(this).get(0))}));d=="onYouTubeIframeAPIReady"&&(y=new YT.Player(e+
"_v_player",{height:b("."+e+" .slide_youtube").height(),width:b("."+e+" .slide_youtube").width(),playerVars:{autoplay:0,controls:m,modestbranding:1},events:{onReady:u,onStateChange:p,onError:F}}));(function(){var b=a.find(".header").height()+a.find(".yucontent").height()+a.find(".footer").height();setWidgetHeight(a,b);if(x==2||x==3)b=parseInt(a.find(".yucontent .main").css("padding-left"))+parseInt(a.find(".yucontent .main").css("padding-right")),b=a.width()-a.find(".playlist").width()-b,a.find(".slide_youtube").css("width",
b)})();c.complete!=null&&c.complete(e)};b.fn.widget.popup=function(a,c,d,e){var d=c.root_path,j=parseInt(a.find("#popup_widget").attr("data-popup-timeout")),f=a.find("#popup_widget").attr("data-transition"),g=a.find("#popup_widget").attr("data-transition-close"),m=a.find("#popup_widget").attr("data-popup-width-type"),h=parseInt(a.find("#popup_widget").attr("data-popup-width")),a=(new Date).getTime(),n=g_storage.get(e+"_popup_expire_time"),r=!1;j<=0||n==""?r=!0:a>n&&(g_storage.set(e+"_popup_expire_time",
""),n="",r=!0);if(r)a={},a.uid=e,b.ajax({url:d+"widget/popup/content_query_json_field.php",data:a,type:"POST",dataType:"json",timeout:2E4,error:function(){},success:function(a){a=decodeURIComponent(a[0].content);a!=""&&(b(a).appendTo(b(".popup .content")),m=="full_width"?b(".popup").css("width",b(window).width()-100):(h>b(window).width()&&(h=b(window).width()-100),b(".popup").css("width",h)),b(".popup").bPopup({speed:1200,transition:f,transitionClose:g,follow:[!1,!1],position:["auto",20],onOpen:function(){if(n==
""&&j>0){var a=new Date;a.setTime(a.getTime()+j*6E4);g_storage.set(e+"_popup_expire_time",a.getTime())}},onClose:function(){b(".popup .content").empty()}}),c.complete!=null&&c.complete(e))}})};b.fn.widget.group=function(a,c,d,e){var j=parseInt(a.find(".abgne_tab").attr("data-widget-type")),f=parseInt(a.find(".abgne_tab").attr("data-widget-average-tab")),f=parseInt(a.find(".abgne_tab").attr("data-widget-average-tab")),g=parseInt(a.find(".abgne_tab").attr("data-widget-open-tab")),m=parseInt(a.find(".abgne_tab").attr("data-widget-length")),
h=parseInt(a.find(".abgne_tab").attr("data-widget-vertical-arrangement-width")),n=a.find(".abgne_tab").attr("data-widget-group-height"),h=parseInt(a.find(".abgne_tab").attr("data-widget-vertical-arrangement-width")),r=a.find(".abgne_tab").attr("data-widget-two-column-width-type"),x=parseInt(a.find(".abgne_tab").attr("data-widget-two-column-left-width")),s=parseInt(a.find(".abgne_tab").attr("data-widget-two-column-right-width")),y=a.find(".abgne_tab").attr("data-widget-three-column-width-type"),t=
parseInt(a.find(".abgne_tab").attr("data-widget-three-column-left-width")),D=parseInt(a.find(".abgne_tab").attr("data-widget-three-column-center-width")),A=parseInt(a.find(".abgne_tab").attr("data-widget-three-column-right-width")),C=function(g,h){var f="."+e+" "+g.find("a").attr("data-href");g.addClass("active").siblings(".active").removeClass("active");b(f).stop(!1,!0).fadeIn().siblings().hide();a.find(".footer").show();var k=b(f).find(".widget-x").attr("id"),i=b.fn.widget[k],v=String(b(f).find(".widget-x").attr("class")).split(" ")[0];
if(b.isFunction(i)){c.complete=function(){h&&b("."+v).attr("tabindex",-1).focus()};c.update_tabindex=function(){a.find(".tab_container .tab-ctl-x").attr("tabindex",0)};if(k=="youtube")c.action="onYouTubeIframeAPIReady";i(b("."+v),c,d,v)}else log("Group: Not implement widget: "+k);b(f).find("iframe").length>0&&(b(f).find("iframe").attr("src",function(a,b){return b}),h&&b(f).find("iframe").focus())};if(j==2){a.find("ul.tabs li").eq(0).addClass("active");a.find(".tab_content").hide().eq(0).show();var z=
a.height(),l=a.find(".tabs").height();n!="auto"&&a.find(".tab_container").css("height",z-l-2);g==1&&a.find("ul.tabs li").mouseover(function(){C(b(this),!1)}).find("a").focus(function(){});a.find("ul.tabs li").click(function(){C(b(this),!1)}).find("a").focus(function(){});a.find("ul.tabs li").keyup(function(a){a.keyCode==13&&C(b(this),!0)}).find("a").focus(function(){})}a.resize(function(){if(j==2&&f==1){var c=(m+b("."+e+" .abgne_tab").width()-parseInt(a.find(".abgne_tab").css("padding-left"))-parseInt(a.find(".abgne_tab").css("padding-right"))-
m*2-1)/m;a.find("ul.tabs li").css("width",c)}a.find("#g-left_sider").removeClass("vertical_arrangement");a.find("#g-center_sider").removeClass("vertical_arrangement");a.find("#g-right_sider").removeClass("vertical_arrangement");a.width()<h&&(j==1?(a.find("#g-left_sider").addClass("vertical_arrangement"),a.find("#g-right_sider").addClass("vertical_arrangement"),r=="custom"&&(a.find("#g-left_sider").css("width",x+"%"),a.find("#g-right_sider").css("width",s+"%"))):j==3&&(a.find("#g-left_sider").addClass("vertical_arrangement"),
a.find("#g-center_sider").addClass("vertical_arrangement"),a.find("#g-right_sider").addClass("vertical_arrangement"),y=="custom"&&(a.find("#g-left_sider").css("width",t+"%"),a.find("#g-center_sider").css("width",D+"%"),a.find("#g-right_sider").css("width",A+"%"))))});c.complete!=null&&c.complete(e)};b.fn.widget.site_news_tab=function(a,c,d,e){var j=c.root_path,f=parseInt(a.find("#sitenews_tab_main").attr("data-class-count")),g=parseInt(a.find("#sitenews_tab_main").attr("data-widget-news-max-rows")),
m=a.find("#sitenews_tab_main").attr("data-widget-newslink-openmode"),h=parseInt(a.find("#sitenews_tab_main").attr("data-widget-average-tab")),d=parseInt(a.find("#sitenews_tab_main").attr("data-widget-open-tab")),n=parseInt(a.find("#sitenews_tab_main").attr("data-widget-news-image-width")),r=parseInt(a.find("#sitenews_tab_main").attr("data-widget-news-image-height")),x=parseInt(a.find("#sitenews_tab_main").attr("data-widget-news-image-show")),s=parseInt(a.find("#sitenews_tab_main").attr("data-widget-height")),
y=!1,t=function(){var b=a.find(".abgne_tab").height();setWidgetHeight(a,b)},D=function(a){b(window.parent).width();b(window.parent).height();C(a,!0,function(a){parseInt(a[0].totalRows);parseInt(a[0].maxRows);var b=a[0].classTitle,c="";c+="<div class='bd' style='font-size:120%'>";c+="<div class='class_title'><h3>"+b+" \u00bb</h3></div>";c+="<ul>";for(b=1;b<a.length;b++){var d=a[b].newsId,E=a[b].title,G=a[b].content,g=a[b].linktype;c+="<li";b==0&&(c+=" class='first'");c+=">";c+="<div class='txt'>";
c+=g=="content"?"<a onclick='load_Site_News_Tab_Content("+d+', "'+e+"\")' title='"+E+"'>":G==""?"<a class='title'>":"<a href='"+G+"' class='title' target='"+m+"'>";c+=E;c+="</a></div></li>"}c+="</ul></div>";popup_content("html","940px",c)})},A=function(a){var c={};c.uid=e;c.nid=a;b.ajax({url:j+"widget/site_news_tab/news_query_content.php",data:c,type:"GET",dataType:"xml",timeout:2E4,error:function(){},success:function(a){var c="";c+="<div class='bd'>";b("entry",a).each(function(){var a=b(this).find("content").text();
c+=a});c+="</div>";popup_content("html","940px",c)}})},C=function(a,c,d){var f={};f.uid=e;f.cid=a;f.maxRows=g;if(c)f.queryall="1";b.ajax({url:j+"widget/site_news_tab/news_query_json.php",data:f,type:"GET",dataType:"json",timeout:2E4,error:function(){},success:function(a){d&&d(a)}})},z=function(d,g){C(g,!1,function(f){var h="",l=0,E=parseInt(f[0].totalRows),G=parseInt(f[0].maxRows);a.find(".tabs").width();a.find(".tab_content").height();h+="<table style='width:100%;table-layout:fixed;'>";h+="<tr>";
h+=x==1?"<td style='vertical-align:top;width:"+(n+10)+"px' headers='table-icon'>":"<td style='vertical-align:top;width:0px' headers='table-icon'>";for(l=1;l<f.length;l++){var w=f[l].newsId,m=f[l].title,j=f[l].image,p=f[l].width,C=f[l].height,I=f[l].content,R=f[l].linktarget,q=f[l].linktype,z=m;if(l==1){var u=n,N=r,M=u,H=N,H=N,M=H*(p/C),o="";M<u?(M=u,H=M*(C/p),o="margin-top:"+(N-H)/2+"px;"):o="margin-left:"+(u-M)/2+"px;";p="width:"+M+"px;";p+="height:"+H+"px;";p+=o;h+="<label class='img-border clearfix'>";
q=="content"?h+="<a class='open-news-x tab-ctl-x' data-id='"+w+"' title='"+m+"'>":q=="url"&&(h+=I==""?"<a title='"+m+"'>":"<a href='"+I+"' title='"+m+"' target='"+R+"'>");h+="<div class='thumb' style='overflow:hidden;width:"+u+"px;height:"+N+"px'>";h+="<img alt='"+m+"' title='"+m+"' src='"+j+"' style='"+p+"'>";h+="</div>";h+="</a>";h+="</label>";h+="</td>";h+="<td style='vertical-align:top;' headers='table-content'>";h+="<div class='news-content'>"}h+="<div class='news'>";q=="content"?h+="<a href='javascript:void(0);' class='open-news-x tab-ctl-x' data-id='"+
w+"' title='"+m+"'>"+z+"</a>":q=="url"&&(h+=I==""?"<a class='tab-ctl-x' title='"+m+"'>"+z+"</a>":"<a class='tab-ctl-x' href='"+I+"' title='"+m+"' target='"+R+"'>"+z+"</a>");h+="</div>"}h+="</div>";h+="</td>";h+="</tr>";E>G&&(h+="<tr><td></td><td>",h+="<span class='btnmore' style='bottom:7px;display:block;padding-left:3px;position:relative;right:7px;text-align:right;'>",h+="<a href='javascript:void(0);' class='open-more-news-x tab-ctl-x' data-id='"+g+"' style='text-decoration:none;cursor:pointer;'>\u00bb \u66f4\u591a</a>",
h+="</span>",h+="</td></tr>");h+="</table>";a.find(d).empty();a.find(d).append(h);a.find(".tab_content").css("padding",5);f=a.find("ul.tabs").height()+15;a.find(".tab_content").css("height",s-f-a.find(".footer").height());a.find(".open-news-x").click(function(){var a=parseInt(b(this).attr("data-id"));A(a)});a.find(".open-more-news-x").click(function(){var a=parseInt(b(this).attr("data-id"));D(a)});t();c.complete!=null&&y==!1&&(c.complete(e),y=!0);c.update_tabindex!=null&&c.update_tabindex(e)})},l=
function(b){var c=b.find("a").attr("href"),d=b.find("a").attr("cid"),c=c.substring(c.indexOf("#"),c.length);b.addClass("active").siblings(".active").removeClass("active");a.find(c).stop(!1,!0).fadeIn().siblings().hide();a.find(".footer").show();z(c,d)};if(f==0)a.find("div.abgne_tab").remove();else{var u=a.find("#tab_header0").attr("href"),p=a.find("#tab_header0").attr("cid");z(u,p);a.find("ul.tabs li").eq(0).addClass("active");a.find(".tab_content").hide().eq(0).show();d==0?a.find("ul.tabs li").click(function(){l(b(this));
return!1}).find("a").focus(function(){}):d==1&&(a.find("ul.tabs li").mouseover(function(){l(b(this));return!1}).find("a").focus(function(){}),a.find("ul.tabs li").click(function(){return!1}));a.find("div.abgne_tab").css("width","100%");a.resize(function(){var b=(a.find(".tabs").width()-f)/f;h==1&&a.find(".site_news_tab_x").css("width",b)})}};b.fn.widget.activities3=function(a,c,d,e){var j=c.root_path;a.find("#main").width();var f=a.find("#main").attr("data-widget-slidecount-perpage"),g=parseInt(a.find("#main").attr("data-widget-left-space")),
m=parseInt(a.find("#main").attr("data-widget-right-space")),h=a.find("#main").attr("data-widget-container-width"),n=parseInt(a.find("#main").attr("data-widget-container-height")),r=parseInt(a.find("#main").attr("data-widget-slideshow-title")),x=parseInt(a.find("#main").attr("data-widget-album-speed"))*1E3,s=0,y=0,t=0,D=0,A="left",C=0,z=0,l=0,u=0,p=function(a){var b="";b+='<div class="slide">';for(var c=1;c<a.length;c++){var d=a[c].album_title,e=a[c].thumb_image,h=a[c].style,g=a[c].url;d+="(\u53e6\u958b\u555f\u65b0\u8996\u7a97)";
b+='<div class="slide_image" style="width:'+C+"px;height:"+z+'px;">';b+='<a href="'+g+'" class="tab-ctl-x" target="_blank">';b+='<img src="'+e+'"';b+=' title="'+d+'"';b+=' alt="'+d+'"';b+=' style="'+h+'">';r==1&&(b+='<div class="album_title_block" title="'+d+'"',b+=' style="color: rgb(255, 255, 255); opacity: 0.65; background: rgb(0, 0, 0);">',b+="<div>"+d+"</div>",b+="</div>");b+="</a>";b+="</div>"}b+="</div>";return b},F=function(){var b=t,c=D;b==0?a.find("#leftControl").hide():a.find("#leftControl").show();
b==c-1?a.find("#rightControl").hide():a.find("#rightControl").show()},k=function(){var d=a.find("#search .input").val()==void 0?"":a.find("#search .input").val(),h={paction:"query_album"};h.uid=e;h.pageNum=t;h.maxRows=f;h.keyword=escape(d);h.ws_width=C;h.ws_height=z;b.ajax({url:j+"widget/activities3/album_query_json.php",data:h,type:"POST",dataType:"json",timeout:2E4,error:function(){alert("Error loading JSON data")},success:function(b){var d=b[0].pageNum,h=b[0].totalPages,g=A,b=p(b);g=="right"?(a.find("#slideInner").css("marginLeft",
-l),a.find("#slideInner").prepend(b)):(g!="left"&&g!="fadeout"&&a.find("#slideInner").empty(),a.find("#slideInner").append(b));a.find(".slide").css({"float":"left",width:l});t=d;D=h;F();if(a.find(".slide").length>1)if(g=="right"){a.find("#slideInner").fadeIn();a.find("#slideInner").animate({marginLeft:0},500,function(){a.find(".slide").last().remove();a.find("#slideInner").css("marginLeft",0)});return}else if(g=="left"){a.find("#slideInner").fadeIn();a.find("#slideInner").animate({marginLeft:-l},
500,function(){a.find(".slide").first().remove();a.find("#slideInner").css("marginLeft",0)});return}else if(g=="fadeout"){a.find("#slideInner").fadeOut(500,function(){a.find(".slide").first().remove();a.find("#slideInner").css("marginLeft",0);a.find("#slideInner").fadeIn()});return}a.find("#div_topbanner").height();a.find("#content").height();parseInt(a.find("#slideshow").css("top"));c.complete!=null&&c.complete(e)}})},i=function(){var a=t,b=D;b<=1||(a+=1,a>b-1?(a=0,A="fadeout"):A="left",t=a,k())},
v=function(a){var b=t,c=D;a.attr("id")=="rightControl"?(b+1>=c?b=c-1:b+=1,A="left"):(b-1<=0?b=0:b-=1,A="right");t=b;D=c;F();k()};a.find("#search .button").click(function(){clearInterval(u);A="none";t=0;k()});a.find("#search .input").keyup(function(b){var c=a.find("#search .input").val()==void 0?"":a.find("#search .input").val();if(b.which==13||c=="")clearInterval(u),A="none",t=0,k()});a.find("#slidesContainer").css("overflow","hidden");a.find("#slideshow").prepend('<span class="control tab-ctl-x" id="leftControl" title="Swipe left" alt="Swipe left"><div class="icon"></div></span>').append('<span class="control tab-ctl-x" id="rightControl" title="Swipe right" alt="Swipe right"><div class="icon"></div></span>');
a.find(".control").hide();a.find(".control").keypress(function(a){a.which==13&&v(b(this))});a.find(".control").bind("click",function(){v(b(this))});a.find(".control").mouseover(function(){b(this).css("background-color","#AAABAC")});a.find(".control").mouseleave(function(){b(this).css("background-color","#6E7070")});a.resize(function(){var b=a.find("#main").width();s=h=="parent_width"?b-g-m:h;y=n;C=Math.floor(s/f);z=y;a.find("#content").css("width",s);l=C*f+2*f;a.find("#slideInner").css("width",l*
2);a.find("#slideInner").css("overflow","hidden");k();clearInterval(u);x<=0||(u=setInterval(i,x))})};b.fn.widget.site_news=function(a,c,d,e){var j=c.root_path;a.find("#main").width();var f=parseInt(a.find("#main").attr("data-show-col-time")),g=parseInt(a.find("#main").attr("data-show-col-attr")),m=parseInt(a.find("#main").attr("data-show-col-unit")),h=parseInt(a.find("#main").attr("data-show-col-user")),n=parseInt(a.find("#main").attr("data-show-col-click")),r=parseInt(a.find("#main").attr("data-show-col-serial")),
x=a.find("#main").attr("data-show-time-format"),s=a.find("#main").attr("data-show-col-order"),y=a.find("#main").attr("data-show-col-time-width"),t=a.find("#main").attr("data-show-col-attr-width"),D=a.find("#main").attr("data-show-col-unit-width"),A=a.find("#main").attr("data-show-col-user-width"),C=a.find("#main").attr("data-show-col-click-width"),z=a.find("#main").attr("data-show-col-serial-width"),l=a.attr("default-attr");l!=-1&&l!=void 0&&(a.find("#search #select_attr_"+e).val(l),a.find("#ntb").attr("flock",
"attr_"+l));var y=y==""||y=="undefined"?"15%":y,t=t==""||t=="undefined"?"15%":t,D=D==""||D=="undefined"?"10%":D,A=A==""||A=="undefined"?"10%":A,C=C==""||C=="undefined"?"10%":C,z=z==""||z=="undefined"?"15%":z,u=!1,p=1;s==""&&(s="Serial,Time,Attr,Unit,News,User,Click");var F=0;f==1&&(F+=15);g==1&&(F+=15);m==1&&(F+=10);h==1&&(F+=10);n==1&&(F+=10);for(var F=100-F,k=[],s=s.split(","),l=0;l<s.length;l++){var i=s[l];r==1&&i=="Serial"?k.push(i):f==1&&i=="Time"?k.push(i):g==1&&i=="Attr"?k.push(i):m==1&&i==
"Unit"?k.push(i):h==1&&i=="User"?k.push(i):n==1&&i=="Click"?k.push(i):i=="News"&&k.push(i)}var v=function(d){for(var h=d[0].flock,g=d[0].field,f=d[0].fval,E=d[0].order,l=d[0].maxRows,m=parseInt(d[0].pageNum),H=parseInt(d[0].totalPages),o="",T=0,K=1;K<d.length;K++){var W=d[K].newsId,Y=d[K].time,X=d[K].attr,aa=d[K].attr_name==""?"\u7121":d[K].attr_name,j=d[K].title,i=d[K].title_color,P=d[K].unit,p=d[K].unit_name==""?"\u7121":d[K].unit_name,r=d[K].issuer,n=d[K].name==""?"\u7121":d[K].name,U=d[K].clicks,
s=d[K].top,x=d[K].content_type,Z=d[K].content,v=parseInt(d[K].permission);o+=T%2==0?'<tr nid="'+W+'" class="tcontent even">':'<tr nid="'+W+'" class="tcontent odd">';for(var B=0;B<k.length;B++){var L=k[B];L=="Serial"&&(o+='<td style="text-align:center;width:'+z+'" order="DESC" field="serial" axis="\u7de8\u865f" >',o+=W,o+="</td>");L=="Time"&&(o+='<td style="text-align:center;width:'+y+'" order="DESC" field="time" axis="\u6642\u9593" >',o+=Y,o+="</td>");L=="Attr"&&(o+='<td style="text-align:center;width:'+
t+'" class="ctrl" order="DESC" field="attr" fval="'+X+'" axis="\u985e\u5225">\u3010'+aa+"\u3011</td>");L=="Unit"&&(o+='<td style="text-align:center;width:'+D+'" class="ctrl" order="DESC" field="unit" fval="'+P+'" title="'+p+'" axis="\u55ae\u4f4d">'+p+"</td>");L=="News"&&(o+='<td order="DESC" field="title" style="width:'+F+'%" axis="\u5167\u5bb9">',$is_locked_news=v>=1?!0:!1,$is_top_news=s=="1"?!0:!1,x=="url"?(o+='<a id="content_href" class="',$is_locked_news&&(o+=" news-locked-x"),$is_top_news&&(o+=
" news-top-x"),o+=" loadnews-url-x",o+=' tab-ctl-x"',o+=' href="'+Z+'" nid="'+W+'" title="'+j+'" target="_blank">'):(o+='<a id="content_href" class="',$is_locked_news&&(o+=" news-locked-x"),$is_top_news&&(o+=" news-top-x"),o+=" loadnews-x",o+=' tab-ctl-x"',o+=' href="javascript:void(0);" nid="'+W+'" title="'+j+'">'),i!=""&&(o+='<span style="color:#'+i+'">'),o+=j,i!=""&&(o+="</span>"),o+="</a>",$is_locked_news&&(o+='<div id="imgLock"></div>'),$is_top_news&&(o+='<div id="imgHot"></div>'),o+="</td>");
L=="User"&&(o+='<td style="text-align:center;width:'+A+'" class="ctrl" order="DESC" field="issuer" fval="'+r+'" axis="\u767c\u4f48">'+n+"</a></td>");L=="Click"&&(o+='<td style="text-align:center;width:'+C+'" order="DESC" field="clicks" axis="\u9ede\u95b1">'+U+"</td>")}o+="</tr>";T++}a.find("#ntb").attr("field",g);a.find("#ntb").attr("flock",h);a.find("#ntb").attr("fval",f);a.find("#ntb").attr("order",E);a.find("#ntb").attr("maxRows",l);a.find("#ntb").attr("pageNum",m);a.find("#ntb").attr("totalPages",
H);a.find("#ntb tbody").html(o);a.find(".loadnews-url-x").unbind("click");a.find(".loadnews-url-x").click(function(){var a=b(this).attr("nid");S(a)});a.find(".loadnews-x").unbind("click");a.find(".loadnews-x").click(function(){var a=b(this).attr("nid");O(a)});a.find("#ntb tbody tr td").unbind("click");a.find("#ntb tbody tr td").click(function(){var c=b(this).attr("field"),d=b(this).attr("fval");b(this).attr("order");if(!(c=="time"||c=="clicks"))if(c=="title")return!0;else a.find("#ntb").attr("field",
"time"),a.find("#ntb").attr("fval",d),a.find("#ntb").attr("order","DESC"),a.find("#ntb").attr("pageNum",0),a.find("#ntb").attr("flock",c+"_"+d),w();return!1});G();c.update_tabindex!=null&&c.update_tabindex(e);c.complete!=null&&u==!1&&(c.complete(e),u=!0)},B=function(a,c){a.replaceWith(function(){return b(c,{html:b(this).html()})})},E=function(){var c=parseInt(a.find("#ntb").attr("totalPages")),d=parseInt(a.find("#ntb").attr("pageNum"));d+=1;c<=1?(a.find("#btnFirst").addClass("disablebtn"),a.find("#btnPrev").addClass("disablebtn"),
a.find("#btnNext").addClass("disablebtn"),a.find("#btnLast").addClass("disablebtn"),B(a.find("#btnFirst a"),"<span/>"),B(a.find("#btnPrev a"),"<span/>"),B(a.find("#btnNext a"),"<span/>"),B(a.find("#btnLast a"),"<span/>")):(d>1?(a.find("#btnFirst").removeClass("disablebtn"),a.find("#btnPrev").removeClass("disablebtn"),B(a.find("#btnFirst span"),"<a/>"),B(a.find("#btnPrev span"),"<a/>"),a.find("#btnFirst a").attr("href","javascript:void(0);"),a.find("#btnPrev a").attr("href","javascript:void(0);")):
(a.find("#btnFirst").addClass("disablebtn"),a.find("#btnPrev").addClass("disablebtn"),B(a.find("#btnFirst a"),"<span/>"),B(a.find("#btnPrev a"),"<span/>")),d==c?(a.find("#btnNext").addClass("disablebtn"),a.find("#btnLast").addClass("disablebtn"),B(a.find("#btnNext a"),"<span/>"),B(a.find("#btnLast a"),"<span/>")):(a.find("#btnNext").removeClass("disablebtn"),a.find("#btnLast").removeClass("disablebtn"),B(a.find("#btnNext span"),"<a/>"),B(a.find("#btnLast span"),"<a/>"),a.find("#btnNext a").attr("href",
"javascript:void(0);"),a.find("#btnLast a").attr("href","javascript:void(0);")),a.find(".btn a").each(function(){b(this).hasClass("tab-ctl-x")||(b(this).addClass("tab-ctl-x"),b(this).attr("tabindex",0))}),Q(),d=parseInt(a.find("#ntb").attr("pageNum"))+1,c=parseInt(a.find("#ntb").attr("totalPages")),a.find("#pageInfo").text(d+" / "+(c==0?1:c)))},G=function(){var b=a.find(".topbanner-x").height()+a.find("#div_table_content").height()+a.find(".footer-x").height()+10;a.find("#search").css("position")!=
"absolute"&&(b+=a.find("#search").height());var c=a.find("#div_table_content").width();a.find("#div_news_table_1_topbanner").css("width",c);c=a.find("#div_table_content").find("#ntb thead tr").eq(0).height();a.find("#div_news_table_1_topbanner").css("height",c);c=a.find("#div_table_content").height();a.find("#div_news_table_1").css("height",c);setWidgetHeight(a,b)},w=function(){var c=parseInt(a.find("#ntb").attr("pageNum")),d=a.find("#ntb").attr("flock"),h=a.find("#ntb").attr("field"),g=a.find("#ntb").attr("fval"),
G=a.find("#ntb").attr("order"),f=a.find("#ntb").attr("maxRows"),l=a.find("#ntb").attr("keyword"),H={};H.field=h;H.order=G;H.pageNum=c;H.maxRows=f;H.keyword=escape(l);if(g!="")H.fval=g;if(d!="")H.flock=d;H.uid=e;H.tf=x;H.auth_type="user";H.use_cache=p;p=0;a.find(".loading").css("left",(a.width()-a.find(".loading").width())/2);a.find(".loading").css("top",50);a.find(".loading").show();b.ajax({url:j+"widget/site_news/news_query_json.php",data:H,type:"POST",dataType:"json",timeout:2E4,error:function(){alert("Fail to load site news!")},
success:function(b){v(b);E();a.find(".loading").hide()}})},O=function(c){var h=a.find("#ntb").attr("maxRows");if(popup_content!=void 0)c=j+"widget/site_news/news_pop_content.php?newsId="+c+"&maxRows_rsResult="+h+"&fh=0&bid="+d+"&uid="+e,popup_content("url","1000px",c);else{var g=0,g=g==0?b(window).height():g,c="news_pop_content.php?newsId="+c+"&maxRows_rsResult="+h+"&fh="+g+"&bid="+d+"&uid="+e;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?window.location=
c:(h=b(window).width()-100,g=b(window).height()-100,b(".popup-news .content").empty(),b(".popup-news").css("width",h),b(".popup-news").css("height",g),b(".popup-news").bPopup({content:"iframe",contentContainer:".content",loadUrl:c,positionStyle:"fixed",position:["auto",20],loadCallback:function(){var a=b(this).find("iframe");a.css("width",b(this).width()+"px");a.css("height",b(this).height()+"px");a.css("background","url()")}},function(){}))}},S=function(a){b.ajax({url:j+"widget/site_news/update_news_clicks.php",
data:"newsId="+a,type:"GET",dataType:"text",timeout:2E4,error:function(){},success:function(){}})},L=function(b){if(b=="btnFirst")a.find("#ntb").attr("pageNum",0),w();else if(b=="btnPrev")b=parseInt(a.find("#ntb").attr("pageNum"))-1,b<=0&&(b=0),a.find("#ntb").attr("pageNum",b),w();else if(b=="btnNext"){var c=parseInt(a.find("#ntb").attr("totalPages")),b=parseInt(a.find("#ntb").attr("pageNum"))+1;b>c-1&&(b=c-1);a.find("#ntb").attr("pageNum",b);w()}else b=="btnLast"&&(b=parseInt(a.find("#ntb").attr("totalPages"))-
1,a.find("#ntb").attr("pageNum",b),w())},Q=function(){a.find("#btnFirst").unbind("click");a.find("#btnFirst").click(function(){if(b(this).hasClass("disablebtn"))return!1;L(b(this).attr("id"))});a.find("#btnPrev").unbind("click");a.find("#btnPrev").click(function(){if(b(this).hasClass("disablebtn"))return!1;L(b(this).attr("id"))});a.find("#btnNext").unbind("click");a.find("#btnNext").click(function(){if(b(this).hasClass("disablebtn"))return!1;L(b(this).attr("id"))});a.find("#btnLast").unbind("click");
a.find("#btnLast").click(function(){if(b(this).hasClass("disablebtn"))return!1;L(b(this).attr("id"))});a.find(".nav-unit-tag-x").unbind("click");a.find(".nav-unit-tag-x").click(function(){if(b(this).hasClass("disablebtn"))return!1;a.find(".nav-unit-tag-x").removeClass("active");b(this).addClass("active");a.find("#ntb").attr("pageNum",0);var c=b(this).attr("data-uid"),d=a.find("#search .select-attr-x"),d=d.val()!=void 0?d.val():-1,e="";c!="-1"&&(e+="unit_"+c);d!="-1"&&(e!=""&&(e+="-"),e+="attr_"+d);
a.find("#ntb").attr("flock",e);w()})};a.find("#ntb").attr("pageNum",0);w();a.find("#ntb thead tr th").unbind("click");a.find("#ntb thead tr th").click(function(){var a=b(this).attr("hid"),c=b(this).attr("order");b("#ntb").attr("field",a);b("#ntb").attr("fval","");b("#ntb").attr("order",c);b(this).attr("order",c=="DESC"?"ASC":"DESC");w();return!1});Q();a.find("#search .button").unbind("click");a.find("#search .button").click(function(){var b=a.find("#search .input").val();a.find("#ntb").attr("pageNum",
0);a.find("#ntb").attr("keyword",b);w()});a.find("#search .input").unbind("keyup");a.find("#search .input").keyup(function(c){var d=b(this).val();if(c.which==13||d=="")a.find("#ntb").attr("pageNum",0),a.find("#ntb").attr("keyword",d),w()});a.find("#search .select-attr-x, #search .select-unit-x").unbind("change");a.find("#search .select-attr-x, #search .select-unit-x").change(function(){var b=a.find("#search .select-unit-x"),c=a.find("#search .select-attr-x"),b=b.val()!=void 0?b.val():-1,c=c.val()!=
void 0?c.val():-1,d="";b!="-1"&&(d+="unit_"+b);c!="-1"&&(d!=""&&(d+="-"),d+="attr_"+c);a.find("#ntb").attr("flock",d);w()});a.unbind("resize");a.resize(function(){G()})};b.fn.widget.site_news2=function(a,c,d,e){function j(a,b){if(b<=1)return"";var c="";c+='<div id="nav_bar">';for(var d=!1,e=0;e<b;e++)e==a?(c+='<span class="btn select"><a class="tab-ctl-x" href="javascript:void(0);">'+(e+1)+"</a></span>",d=!1):e-a>1&&e!=b-1&&e!=0&&b>5?d==!1&&(c+='<span class="btn skip next"><a class="tab-ctl-x" href="javascript:void(0);">...</a></span>',
d=!0):e-a<-1&&e!=b-1&&e!=0&&b>5?d==!1&&(c+='<span class="btn skip prev"><a class="tab-ctl-x" href="javascript:void(0);">...</a></span>',d=!0):c+='<span class="btn" data-page="'+e+'"><a class="tab-ctl-x" href="javascript:void(0);">'+(e+1)+"</a></span>";c+="</div>";return c}var f=c.root_path;a.find("#widget_main").width();var g=parseInt(a.find("#widget_main").attr("data-show-col")),m=parseInt(a.find("#widget_main").attr("data-show-col-time")),h=parseInt(a.find("#widget_main").attr("data-show-col-attr")),
n=parseInt(a.find("#widget_main").attr("data-show-col-unit")),r=parseInt(a.find("#widget_main").attr("data-show-col-user")),x=parseInt(a.find("#widget_main").attr("data-show-col-click"));parseInt(a.find("#widget_main").attr("data-show-col-serial"));var s=a.find("#widget_main").attr("data-show-time-format"),y=decodeURIComponent(a.find("#widget_main").attr("data-col-time-title")),t=decodeURIComponent(a.find("#widget_main").attr("data-col-attr-title")),D=decodeURIComponent(a.find("#widget_main").attr("data-col-unit-title")),
A=decodeURIComponent(a.find("#widget_main").attr("data-col-user-title")),C=decodeURIComponent(a.find("#widget_main").attr("data-col-click-title")),z=a.find("#widget_main").attr("data-widget-layout"),l=a.attr("default-attr"),u=!1;l!=-1&&l!=void 0&&(a.find("#search #select_attr_"+e).val(l),a.find("#ntb").attr("flock","attr_"+l));var p=function(d,f){var l=f[0].flock,p=f[0].field,s=f[0].fval,z=f[0].order,F=f[0].maxRows,I=parseInt(f[0].pageNum),R=parseInt(f[0].totalPages),q="",V=0;q+="<ul class='"+d+"'>";
for(var J=1;J<f.length;J++){var N=f[J].newsId,M=f[J].time,H=f[J].attr_name==""?"\u7121":f[J].attr_name,o=f[J].title,T=f[J].unit_name==""?"\u7121":f[J].unit_name,K=f[J].name==""?"\u7121":f[J].name,W=f[J].clicks,Y=f[J].content_type,X=f[J].content;parseInt(f[J].permission);var aa=f[J].news_image,ba=f[J].news_image_width,ca=f[J].news_image_height;q+='<li class="item">';q+='<div class="imgBox">';g_web_accessibility==0&&(q+=Y=="url"?'<a id="content_href" class="loadnews-url-x" href="'+X+'" nid="'+N+'" title="'+
o+'" target="_blank">':'<a id="content_href" class="loadnews-x" href="javascript:void(0);" nid="'+N+'" title="'+o+'">');q+='<img src="'+aa+'"';q+=' data-width="'+ba+'"';q+=' data-height="'+ca+'"';q+=' alt="'+o+'">';g_web_accessibility==0&&(q+="</a>");q+="</div>";q+='<div class="textBox">';q+='<div class="atitle">';q+=Y=="url"?'<a id="content_href" class="loadnews-url-x tab-ctl-x" href="'+X+'" nid="'+N+'" title="'+o+'" target="_blank">':'<a id="content_href" class="loadnews-x tab-ctl-x" href="javascript:void(0);" nid="'+
N+'" title="'+o+'">';q+=o;q+="</a>";q+="</div>";q+='<div class="adec">';g_web_accessibility==0&&(q+=Y=="url"?'<a id="content_href" class="loadnews-url-x" href="'+X+'" nid="'+N+'" title="'+o+'" target="_blank">':'<a id="content_href" class="loadnews-x" href="javascript:void(0);" nid="'+N+'" title="'+o+'">');q+=X;g_web_accessibility==0&&(q+="</a>");q+="</div>";q+='<div id="news_info" class="ainfo">';g==1&&(m&&(q+=y,q+=":",q+=M,q+=" | "),h&&(q+=t,q+=":",q+=H,q+=" | "),n&&(q+=D,q+=":",q+=T,q+=" | "),
r&&(q+=A,q+=":",q+=K,q+=" | "),x&&(q+=C,q+=":",q+=W,q+=" | "));q+="</div>";q+="</div>";q+="</li>";V++}q+="</ul>";a.find("#ntb").attr("field",p);a.find("#ntb").attr("flock",l);a.find("#ntb").attr("fval",s);a.find("#ntb").attr("order",z);a.find("#ntb").attr("maxRows",F);a.find("#ntb").attr("pageNum",I);a.find("#ntb").attr("totalPages",R);a.find("#ntb").html(q);a.find(".loadnews-url-x").unbind("click");a.find(".loadnews-url-x").click(function(){var a=b(this).attr("nid");B(a)});a.find(".loadnews-x").unbind("click");
a.find(".loadnews-x").click(function(){var a=b(this).attr("nid");v(a)});a.find("#div_nav").html(j(I,R));a.find("#div_nav .btn").unbind("click");a.find("#div_nav .btn").click(function(){var c=b(this).attr("data-page");a.find("#ntb").attr("pageNum",c);i()});a.find("#div_nav .next").unbind("click");a.find("#div_nav .next").click(function(){var b=parseInt(a.find("#ntb").attr("totalPages")),c=parseInt(a.find("#ntb").attr("pageNum"))+1;c>b-1&&(c=b-1);a.find("#ntb").attr("pageNum",c);i()});a.find("#div_nav .prev").unbind("click");
a.find("#div_nav .prev").click(function(){var b=parseInt(a.find("#ntb").attr("pageNum"))-1;b<=0&&(b=0);a.find("#ntb").attr("pageNum",b);i()});k();c.complete!=null&&u==!1&&(c.complete(e),u=!0);c.update_tabindex!=null&&c.update_tabindex(e)},F=function(){a.find(".imgBox img").each(function(){var c=b(this),d=c.attr("data-width"),e=c.attr("data-height"),f=a.find(".imgBox").width(),h=a.find(".imgBox").height(),g=h+1;d==0||e==0?(b(this).css("height",g),b(this).css("width","auto"),setTimeout(function(){var a=
c.prop("width"),b=c.prop("height"),b=(h-b)/2;c.css("left",(f-a)/2);c.css("top",b)},700)):(d*=g/e,e=g,b(this).css("height",e),b(this).css("width","auto"),e=(h-e)/2,c.css("left",(f-d)/2),c.css("top",e))})},k=function(){var b=a.find(".topbanner-x").height()+a.find("#div_news_table_1").height()+a.find(".footer-x").height(),c=a.width();c-=parseInt(a.find(".news_main").css("padding-left"));c-=parseInt(a.find(".news_main").css("padding-right"));a.find(".news_main").css("width",c);F();a.hasClass("widget-open-in-menu")?
setMainHeight(b):setWidgetHeight(a,b);adjustSectionSize()},i=function(){var c=parseInt(a.find("#ntb").attr("pageNum")),d=a.find("#ntb").attr("flock"),h=a.find("#ntb").attr("field"),g=a.find("#ntb").attr("fval"),l=a.find("#ntb").attr("order"),m=a.find("#ntb").attr("maxRows"),k=a.find("#ntb").attr("keyword"),j={};j.field=h;j.order=l;j.pageNum=c;j.maxRows=m;j.keyword=escape(k);if(g!="")j.fval=g;if(d!="")j.flock=d;j.uid=e;j.tf=s;j.auth_type="user";j.show_brief_content=1;j.show_content_image=1;a.find(".loading").css("left",
(a.width()-a.find(".loading").width())/2);a.find(".loading").css("top",50);a.find(".loading").show();b.ajax({url:f+"widget/site_news/news_query_json.php",data:j,type:"POST",dataType:"json",timeout:2E4,error:function(){alert("Fail to load site news!")},success:function(b){p(z,b);var b=parseInt(a.find("#ntb").attr("totalPages")),c=parseInt(a.find("#ntb").attr("pageNum"))+1;b<=1?(a.find("#btnFirst").addClass("disable"),a.find("#btnPrev").addClass("disable"),a.find("#btnNext").addClass("disable"),a.find("#btnLast").addClass("disable")):
(c>1?(a.find("#btnFirst").removeClass("disable"),a.find("#btnPrev").removeClass("disable")):(a.find("#btnFirst").addClass("disable"),a.find("#btnPrev").addClass("disable")),c==b?(a.find("#btnNext").addClass("disable"),a.find("#btnLast").addClass("disable")):(a.find("#btnNext").removeClass("disable"),a.find("#btnLast").removeClass("disable")));a.find(".loading").hide()}})},v=function(c){var h=a.find("#ntb").attr("maxRows");if(popup_content!=void 0)c=f+"widget/site_news/news_pop_content.php?newsId="+
c+"&maxRows_rsResult="+h+"&fh=0&bid="+d+"&uid="+e,popup_content("url","1000px",c);else{var g=0,g=g==0?b(window).height():g,c="news_pop_content.php?newsId="+c+"&maxRows_rsResult="+h+"&fh="+g+"&bid="+d+"&uid="+e;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?window.location=c:(h=b(window).width()-100,g=b(window).height()-100,b(".popup-news .content").empty(),b(".popup-news").css("width",h),b(".popup-news").css("height",g),b(".popup-news").bPopup({content:"iframe",
contentContainer:".content",loadUrl:c,positionStyle:"fixed",position:["auto",20],loadCallback:function(){var a=b(this).find("iframe");a.css("width",b(this).width()+"px");a.css("height",b(this).height()+"px");a.css("background","url()")}},function(){}))}},B=function(a){b.ajax({url:f+"widget/site_news/update_news_clicks.php",data:"newsId="+a,type:"GET",dataType:"text",timeout:2E4,error:function(){},success:function(){}})};a.find("#ntb").attr("pageNum",0);i();a.find("#ntb thead tr th").unbind("click");
a.find("#ntb thead tr th").click(function(){var a=b(this).attr("hid"),c=b(this).attr("order");b("#ntb").attr("field",a);b("#ntb").attr("fval","");b("#ntb").attr("order",c);b(this).attr("order",c=="DESC"?"ASC":"DESC");i();return!1});a.find("#btnFirst").unbind("click");a.find("#btnFirst").click(function(){if(b(this).hasClass("disablebtn"))return!1;a.find("#ntb").attr("pageNum",0);i()});a.find("#btnPrev").unbind("click");a.find("#btnPrev").click(function(){if(b(this).hasClass("disablebtn"))return!1;
var c=parseInt(a.find("#ntb").attr("pageNum"))-1;c<=0&&(c=0);a.find("#ntb").attr("pageNum",c);i()});a.find("#btnNext").unbind("click");a.find("#btnNext").click(function(){if(b(this).hasClass("disablebtn"))return!1;var c=parseInt(a.find("#ntb").attr("totalPages")),d=parseInt(a.find("#ntb").attr("pageNum"))+1;d>c-1&&(d=c-1);a.find("#ntb").attr("pageNum",d);i()});a.find("#btnLast").unbind("click");a.find("#btnLast").click(function(){if(b(this).hasClass("disablebtn"))return!1;var c=parseInt(a.find("#ntb").attr("totalPages"))-
1;a.find("#ntb").attr("pageNum",c);i()});a.find("#search .button").unbind("click");a.find("#search .button").click(function(){var b=a.find("#search .input").attr("value");a.find("#ntb").attr("pageNum",0);a.find("#ntb").attr("keyword",b);i()});a.find("#search .input").unbind("keyup");a.find("#search .input").keyup(function(c){var d=b(this).val();if(c.which==13||d=="")a.find("#ntb").attr("pageNum",0),a.find("#ntb").attr("keyword",d),i()});a.find("#search #select_attr, #search #select_unit").unbind("change");
a.find("#search #select_attr, #search #select_unit").change(function(){var c=a.find("#search #select_unit").val()!=void 0?a.find("#search #select_unit").val():-1,d=a.find("#search #select_attr").val()!=void 0?a.find("#search #select_attr").val():-1,e="";c!="-1"&&(e+="unit_"+c);d!="-1"&&(e!=""&&(e+="-"),e+="attr_"+d);b("#ntb").attr("flock",e);i()});a.find(".nav-next-arrow-type").unbind("click");a.find(".nav-next-arrow-type").click(function(){var b=parseInt(a.find("#ntb").attr("totalPages")),c=parseInt(a.find("#ntb").attr("pageNum"));
c!=b-1&&(c+=1,c>b-1&&(c=b-1),a.find("#ntb").attr("pageNum",c),i())});a.find(".nav-prev-arrow-type").unbind("click");a.find(".nav-prev-arrow-type").click(function(){var b=parseInt(a.find("#ntb").attr("pageNum"));b!=0&&(b-=1,b<=0&&(b=0),a.find("#ntb").attr("pageNum",b),i())});a.unbind("mouseover");a.mouseover(function(){a.find(".nav-arrow-type").animate({opacity:0.7},200)});a.unbind("mouseleave");a.mouseleave(function(){a.find(".nav-arrow-type").animate({opacity:0.3},200)});a.find(".nav-arrow-type").animate({opacity:0.3},
200);a.unbind("resize");a.resize(function(){k()})};b.fn.widget.air_quality=function(a,c,d,e){d=c.root_path;a.find("#main").width();parseInt(a.find("#main").attr("data-show-col-time"));var j={};j.uid=e;b.ajax({url:d+"widget/air_quality/content_query_json.php",data:j,type:"POST",dataType:"json",timeout:2E4,error:function(){},success:function(b){var d="";b.result=="success"?(d+='<span class="site"><span class="title">'+b.data.site+"</span></span>",d+='<div class="info" style="background-color:#'+b.data.color+
'">',d+='<span class="aqi">'+b.data.aqi+"</span>",d+='<span class="status">'+b.data.status+"</span>",d+='<span class="update_time">'+b.data.update_time+"</span>",d+="</div>"):d+='<span class="error">'+b.err_message+"</span>";a.find(".qcontent .main").html(d);c.complete!=null&&c.complete(e)}})};b.fn.widget.db_show=function(a,c,d,e,j){var f=c.root_path,d=c.action,g=e+"_client_id",m=g_storage.get(g),h=a.find("#db_show_main").attr("data-access-token"),n=parseInt(a.find("#db_show_main").attr("data-widget-hr")),
r=a.find("#db_show_main").attr("data-widget-cat-field");a.find("#db_show_main").attr("data-widget-search-field");var x=a.find("#db_show_main").attr("data-widget-header-field"),s=a.find("#db_show_main").attr("data-widget-icon-field"),y=a.find("#db_show_main").attr("data-widget-file-field"),t=a.find("#db_show_main").attr("data-widget-title-field"),D=a.find("#db_show_main").attr("data-widget-clicks-field"),A=a.find("#db_show_main").attr("data-widget-shown-fields"),C=a.find("#db_show_main").attr("data-widget-open-fields"),
z=a.find("#db_show_main").attr("data-widget-open-customize-url"),l=a.find("#db_show_main").attr("data-widget-open-customize-label"),u=parseInt(a.find("#db_show_main").attr("data-widget-column-count")),p=parseInt(a.find("#db_show_main").attr("data-widget-row-count")),F=u*p,k=parseInt(a.find("#db_show_main").attr("data-widget-field-layout")),i=a.find("#db_show_main").attr("data-login-permission-scope"),i=i==""?"token":i,v=!1,B=r+","+x+","+s+","+y+","+t+","+A,E=0,G=null,w="",O="";m==""&&(m=e+"."+(new Date).getTime(),
g_storage.set(g,m));var G=a.find("#dialog_advance_search").dialog({autoOpen:!1,width:600,modal:!0,draggable:!1,resizable:!1,buttons:{"\u78ba\u5b9a":function(){I(0);G.dialog("close")}}}),S=function(){a.find("#person_name").html("");a.find("#option_logout").hide();a.find(".login-x").show();a.find(".login-x #section_login").css("top",Math.min(100,(a.find(".login-x").height()-a.find(".login-x #section_login").height())/2))},L=function(){var a="";b("#"+e+"_boxSearchField").find(".search_keyword_field").each(function(){var c=
b(this).find(".keyword-fuzzy-search").prop("checked");b(this).find(".keyword-field").val()!=""&&(a!=""&&(a+=","),a+=b(this).attr("data-field"),a+="<",a+=c?"?"+b(this).find(".keyword-field").val()+"?":b(this).find(".keyword-field").val())});b("#"+e+"_boxSearchField").find(".search_subitem_field").each(function(){var c=b(this).find(".keyword-field:checked");c.length>0&&(a!=""&&(a+=","),a+=b(this).attr("data-field"),a+="<",c.each(function(d){var e=b(this).attr("data-item-type"),h=!!parseInt(b(this).attr("data-editable"));
e=="multi-select"&&(a+="?");a+=b(this).attr("data-title");if(e=="multi-select"||h)a+="?";d!=c.length-1&&(a+=">")}))});a=encodeURIComponent(a);if(a=="")for(var c=(t+","+A).split(","),d=0;d<c.length;d++)c[d]!=""&&(a!=""&&(a+=","),a+="hr_field."+c[d]);return a},Q=function(a,b){return typeof a!="string"?"":a.length>b?a.substring(0,b)+"...":a},I=function(d){if(!v){w=L();if(r!=""){var g=decodeURIComponent(a.find("ul.tabs li.active").find("a").attr("data-title"));w!=""&&(w+=",");w+="hr_item_list."+r+"<"+
g}b(".select-search-field-x").each(function(){var a=b(this).attr("data-search-fields"),c=b(this).val();c!="all"&&(w!=""&&(w+=","),w+="hr_item_list."+a+"<"+c)});O=a.find("#search .input").val();var g=get_api_url("hr.items.get"),f={};f.hid=n;f.shown_column=B;f.order="";f.pageNum=d;f.maxRows=F;f.keyword_field=w;f.keyword=O;f.rule="and";f.auth=i=="no"?"token":i;f.token=h;f.uid=e;a.find(".data_container").html("<span class='loading-x'>Loading...</span>");v=!0;b.ajax({url:g,data:f,type:"POST",dataType:"json",
timeout:2E4,error:function(a){v=!1;a.status==401&&S()},success:function(b){var d="",f=parseInt(b[0].pageNum);parseInt(b[0].totalRows);var g=parseInt(b[0].totalPages);parseInt(b[0].enable_d_confirm);d+="";for(var j=1;j<b.length;j++){var m=b[j].id,o=b[j].fields;parseInt(b[j].confirm_permission);parseInt(b[j].d_confirm);var P="";y=="print_item"?(P=g_root_path+"public/hr/print_item.php?auth_type=token&token="+h+"&hid="+n+"&hiid="+m+"&window=1",C!=""&&(P+="&scol="+C)):P=y=="customize_url"?z.indexOf("?")==
-1?z+"?hiid="+m:z+"&hiid="+m:V(o,y);d+="<div class='item-show'>";d+=k==1?"<div class='top-section'>":"<div class='left-section'>";var i=V(o,x);i!=""&&(d+="<img class='item-header",P!=""&&(d+=" item-open-x"),d+="'",d+=" id='item_show_image_gst'",d+=" src='"+i+"'",d+=" data-id='"+m+"'",d+=" data-url='"+P+"'",d+="/>");i=V(o,s);d+="<img class='item-icon";P!=""&&(d+=" item-open-x");d+="'";i!=""?(d+=" id='item_show_image_gsh'",d+=" src='"+i+"'"):d+=" id='item_show_image'";d+=" data-id='"+m+"'";d+=" data-url='"+
P+"'";d+="/>";d+="</div>";d+=k==1?"<div class='bottom-section'>":"<div class='right-section'>";a:{for(i=0;i<o.length;i++){var p=o[i].infos_count,T=o[i].infos;if(t==o[i].name){if(p>0){i=T[0].show;break a}break}}i=void 0}d+="<div class='item-title'>";d+=Q(i,20);d+="</div>";for(p=0;p<o.length;p++){var T=o[p].type,U=o[p].name,r=o[p].title,H=o[p].infos_count,Z=o[p].infos,i=o[p].value;if(A.indexOf(U)!=-1){d+="<div class='item-field'>";d+="<span class='item-field-label'>";d+=r;d+="\uff1a";d+="</span>";for(U=
0;U<H;U++){var r=Z[U].show,q=Z[U].path;d+=H>1?"<span class='item-field-values'>":"<span class='item-field-value'>";q!=""?d+="<a href='"+q+"' target='_blank'>"+r+"</a>":T=="multi-string"?(r=i.replaceAll("\n","<br>"),r!=""&&(d+="<div>"+r+"</div>")):d+=Q(r,100);d+="</span>"}d+="</div>"}}d+="</div>";P!=""&&(d+="<div class='open-section'>",d+="<a class='item-open-x' id='item_open'",d+=" data-id='"+m+"'",d+=" data-url='"+P+"'",d+=">",d+=l,d+="</a>",d+="</div>");d+="</div>"}if(g>1){b="";b+='<div style="width:100%;float:left">';
b+='<div class="navDiv">';f>0?(b+='<a class="nav-load-x" data-page="0">|&lt;</a>',b+='<a class="nav-load-x" data-page="'+(f-1)+'">&lt;&lt;</a>'):b+='<span class="disable">|&lt;</span><span class="disable">&lt;&lt;</span>';j=!1;for(m=0;m<g;m++)m==f?(b+='<span class="select">'+(m+1)+"</span>",j=!1):Math.abs(m-f)>2&&m!=g-1&&m!=0&&g>10?j==!1&&(b+="<span>...</span>",j=!0):b+='<a class="nav-load-x" data-page="'+m+'">'+(m+1)+"</a>";f<g-1?(b+='<a class="nav-load-x" data-page="'+(f+1)+'">&gt;&gt;</a>',b+=
'<a class="nav-load-x" data-page="'+(g-1)+'">&gt;|</a>'):b+='<span class="disable">&gt;&gt;</span><span class="disable">&gt;&gt;|</span>';b+="</div>";b+="</div>";d+=b}a.find(".data_container").html(d);J();M();c.complete!=null&&c.complete(e);v=!1}})}},R=function(a,c,d){var f=get_api_url("hr.item.value.get"),g={};g.hid=n;g.hiid=a;g.field_name=c;g.auth=i=="no"?"token":i;g.token=h;g.uid=e;b.ajax({url:f,data:g,type:"POST",dataType:"json",timeout:2E4,error:function(){},success:function(a){d&&d(a.value)}})},
q=function(a){R(a,D,function(c){if(isNaN(c)||c=="")c=0;var d=get_api_url("hr.item.value.set"),f={};f.hid=n;f.hiid=a;f.field_name=D;f.field_value=parseInt(c)+1;f.auth=i=="no"?"token":i;f.token=h;f.uid=e;b.ajax({url:d,data:f,type:"POST",dataType:"json",timeout:2E4,error:function(){},success:function(){}})})},V=function(a,b){for(var c=0;c<a.length;c++){var d=a[c].infos_count,e=a[c].infos;if(b==a[c].name){if(d>0)return e[0].path!=""&&e[0].path!=void 0?e[0].path:"";break}}return""},J=function(){a.find(".item-open-x").click(function(){var a=
b(this).attr("data-id"),c=b(this).attr("data-url");q(a);c.indexOf("print_item.php")!=-1?popup_content("url","1000px",c):window.open(c)});a.find(".nav-load-x").click(function(){I(b(this).attr("data-page"))})},g=function(a,c){var d=get_api_url("hr.permission.get"),e={};e.auth=i=="no"?"token":i;e.hid=n;e.token=a;b.ajax({url:d,data:e,type:"POST",dataType:"json",timeout:2E4,error:function(){S()},success:function(){N(a,c)}})},N=function(d,f){var g=get_api_url("userinfo.get"),h={};h.auth=i=="no"?"token":
i;h.token=d;b.ajax({url:g,data:h,type:"POST",dataType:"json",timeout:2E4,error:function(){S()},success:function(b){a.find("#person_name").html(b.name);a.find("#option_logout").show();a.find(".login-x").hide();I(0);f&&f(b);c.complete!=null&&c.complete(e)}})},M=function(){var c=0,c=a.find(".dbcontent").width();parseInt(a.find(".main").css("padding-left"));parseInt(a.find(".main").css("padding-right"));var d=u;c>328&&c<=628?d=2:c<=328&&(d=1);a.find(".main").css("width","100%");a.find(".item-show").css("width",
c/d-28);var e=300;a.find(".item-show").each(function(){var a=0,a=k==1?b(this).find(".top-section").height()+b(this).find(".bottom-section").height()+10+50:Math.max(b(this).find(".right-section").height(),200)+50;a>e&&(e=a)});a.find(".item-show").css("height",e);c=a.find(".header").height()+a.find(".dbcontent").height()+a.find(".footer").height();a.find(".dbshowcontent").is(":visible")&&(c+=a.find(".dbshowcontent").height());E!=c&&(E=c,a.hasClass("widget-open-in-menu")?setMainHeight(E):setWidgetHeight(a,
E),adjustSectionSize())};if(d=="onLoginHandler")return h=typeof j=="undefined"?"":j,log("setToken: "+h+" and start to query person info"),g(h,function(){h!=""&&(log(storageTokenName+" = "+h),g_storage.set(storageTokenName,h));window.location.reload()}),this;a.find("ul.tabs li").eq(0).addClass("active");a.find(".tab_content").hide().eq(0).show();a.find("ul.tabs li").click(function(){var c=b(this),d=c.find("a").attr("href");c.find("a").attr("cid");d=d.substring(d.indexOf("#"),d.length);c.addClass("active").siblings(".active").removeClass("active");
a.find(d).stop(!1,!0).fadeIn().siblings().hide();a.find(".footer").show();I(0);return!1}).find("a").focus(function(){this.blur()});a.find("ul.tabs li a").focus(function(){var c=b(this),d=c.attr("href");c.attr("cid");d=d.substring(d.indexOf("#"),d.length);c.parent("li").addClass("active").siblings(".active").removeClass("active");a.find(d).stop(!1,!0).fadeIn().siblings().hide();a.find(".footer").show();I(0);return!1}).find("a").focus(function(){this.blur()});a.find("#search #sa").unbind("click");a.find("#search #sa").click(function(){I(0)});
a.find("#search #ads").unbind("click");a.find("#search #ads").click(function(){G.dialog("open")});a.find("#search .input").unbind("keyup");a.find("#search .input").keyup(function(b){O=a.find("#search .input").val();(b.which==13||O=="")&&I(0)});a.find(".select-search-field-x").unbind("change");a.find(".select-search-field-x").change(function(){I(0)});a.find("#btn_login_w").click(function(){var a=f+"config/login.php",b=encodeURI("hid="+n),a=a+"?response_type="+(i=="token"?"token":"session")+"&client_id="+
m+"&permission_scope=hr&scope=userinfo.get,hr.item.create,hr.items.get,hr.item.set,hr.item.get,hr.reviewer.get,hr.item.display.create,hr.items.related.value.get,hr.permission.get,hr.item.input.data.get,hr.item.update,hr.item.temp.get,hr.item.temp.create,hr.item.temp.update&data="+b+"&continue="+encodeURIComponent(f+"public/open_id/callback.html?callback=onWidgetLoginSuccess&uid="+e);window.open(a,"mywindow","menubar=1,resizable=1,width=630,height=630, top=100, left=300")});a.find("#btn_logout").click(function(){if(i==
"token")g_storage.set(storageTokenName,""),window.location.reload();else{var a=get_api_url("user.logout"),c={};c.auth=i;b.post(a,c,function(){window.location.reload()})}});a.resize(function(){M()});i=="no"?(a.find(".dbshowcontent").hide(),I(0)):(a.find(".dbshowcontent").show(),g(h,null))};b.fn.widget.db_step=function(a,c,d,e,j){var f=c.root_path,d=c.action,g=e+"_client_id",m=e+"_token",h=parseInt(a.find("#db_step_main").attr("data-widget-hr")),n=a.find("#db_step_main").attr("data-widget-layout"),
r=!!parseInt(a.find("#db_step_main").attr("data-open-input")),x=parseInt(a.find("#db_step_main").attr("data-hide-data-list")),s=a.find("#db_step_main").attr("data-confirm-template"),y=a.find("#db_step_main").attr("data-show-confirm-content"),t=a.find("#db_step_main").attr("data-finish-template"),D=a.find("#db_step_main").attr("data-show-finish-content"),A=parseInt(a.find("#db_step_main").attr("data-related-hr")),C=a.find("#db_step_main").attr("data-shown-column"),z=parseInt(a.find("#db_step_main").attr("data-step-count")),
l=!!parseInt(a.find("#db_step_main").attr("data-widget-enable-all-steps")),u=g_storage.get(g),p=g_storage.get(m),F=0,k=0,i=!1,v=a.find("#db_step_main").attr("data-login-permission-scope"),v=v==""?"token":v,B=-1,E=-1,G=-1,w=null,O=!0,S=-1;if(h<=0)a.find(".readme").html("<li>\u5c1a\u672a\u8a2d\u5b9a\u8cc7\u6599\u5eab</li>");else{u==""&&(u=e+"."+(new Date).getTime(),g_storage.set(g,u));var L=function(){r||(a.find("#person_name").html(""),a.find("#option_logout").hide(),a.find(".login-x").show(),a.find(".login-x #section_login").css("top",
Math.min(100,(a.find(".login-x").height()-a.find(".login-x #section_login").height())/2)))},Q=function(){var c=0,d=0;a.find(".current").find(".signup-column").each(function(){var a=b(this).height();if(a==0)return!1;a+=parseInt(b(this).css("padding-top"));a+=parseInt(b(this).css("padding-bottom"));c+=a});c+=a.find(".current .section-desc-x").height()+150;a.find(".content").css("height",c);d=a.find(".header").height()+a.find(".dbstepcontent").height()+a.find(".footer").height();k!=d&&(k=d,a.hasClass("widget-open-in-menu")?
(k+=20,setMainHeight(k)):setWidgetHeight(a,k),adjustSectionSize())},I=function(){var c=a.find(".user_input"),d=function(a){if(typeof a=="undefined"||a=="")return null;a=decodeURIComponent(a);try{a=JSON.parse(a)}catch(b){return null}return a},e=function(a,d){if(typeof d=="undefined")return!0;var e=a=="or"?1:d.length,f=0,g=!1,h=function(a,b,c){if(c=="="&&a==b)return!0;else if(c==">"&&a>b)return!0;else if(c==">="&&a>=b)return!0;else if(c=="<"&&a<b)return!0;else if(c=="<="&&a<=b)return!0;else if(c=="!="&&
a!=b)return!0;return!1};if(d.length<=0)return!0;for(var m=0;m<d.length;m++){var l=d[m].field_name,j=d[m].field_value,i=d[m].condition;l=="hr_account_permission"?h(S,j,i)&&f++:c.each(function(){var a=b(this).attr("data-id"),c=b(this).attr("data-type"),d="";if(a!=l)return!0;c=="single-select"?b(this).find("input[type=radio]").each(function(){var c=b(this).attr("data-id"),e=b(this).attr("data-title"),f=b(this).attr("data-editable");b(this).prop("checked")&&(d=e,f==1&&(d+=",",d+=b("#"+a).find("#input_subitem_"+
c).val()))}):c=="combobox"?b(this).find("option").each(function(){var a=b(this).attr("data-title");b(this).prop("selected")&&(d=a)}):d=b(this).val();h(d,j,i)&&f++;return!1});if(f>=e){g=!0;break}}return g};c.each(function(){var a=b(this).attr("data-id"),f=b(this).attr("data-type"),g=b(this).hasClass("manual-user-input-x");if(f=="computation"&&g==!1){var f=b(this).attr("data-formula"),g=b(this).attr("data-basefield"),h=b(this).attr("data-basefield-computation"),m=b(this).attr("data-field"),l=b(this).attr("data-field-computation"),
j=b(this).attr("data-number-of-digits");m!=void 0&&m!=""&&(m=m.split(","),b(this).val(doComputationField(f,g,h,m,l,c,j)))}if(b("#"+a).hasClass("user_unique_col"))return!0;f=b(this).attr("data-display-rule");g=d(f);if(g!=null)f=g.match,g=g.rules,f=e(f,g),g=b("#"+a),h=b("#input_"+a),typeof g=="undefined"||typeof h=="undefined"||(f&&g.hasClass("signup-column-hidden")?(g.show(),g.removeClass("signup-column-hidden")):!f&&!g.hasClass("signup-column-hidden")&&(g.hide(),g.addClass("signup-column-hidden"),
h.val("")));f=b(this).attr("data-must-rule");g=d(f);if(g!=null)f=g.display_match,g=g.display_rules,f=e(f,g),g=b("#"+a),a=b("#input_"+a),typeof g!="undefined"&&(f?(g.find(".input-must-text").show(),a.attr("data-must","true")):f||(g.find(".input-must-text").hide(),a.attr("data-must","false")))})},R=function(){var c=a.find("a[href$='#finish']").parent("li");if(!c.hasClass("disabled")&&!i){if(check_file_is_uploading())return alert("\u6a94\u6848\u6b63\u5728\u4e0a\u50b3\u4e2d\uff0c\u8acb\u7b49\u5f85\u4e0a\u50b3\u5b8c\u6210!"),
!1;if(!check_file_is_complete())return alert("\u6a94\u6848\u4e0a\u50b3\u672a\u5b8c\u6210\uff0c\u8acb\u91cd\u65b0\u4e0a\u50b3\u6a94\u6848!"),!1;var d=g_storage.get(m),e=get_user_input_array_result(a.find(".body"));i=!0;var f=get_api_url("hr.item.create"),g={};g.auth=v;g.token=r?"db_step_access_token":d;g.hid=h;g.data=JSON.stringify(e);g.upload_column=gen_upload_value();if(B>0)f=get_api_url("hr.item.update"),g.hiid=B;g.temp=E;c.addClass("disabled");b.ajax({url:f,data:g,type:"POST",dataType:"json",timeout:2E4,
error:function(a){a.status==701?alert("\u6c92\u6709\u586b\u5beb\u552f\u4e00\u6b04\u4f4d\u5167\u5bb9\uff01"):a.status==702?alert("\u8cc7\u6599\u5df2\u7d93\u5b58\u5728\uff01"):a.status==704?alert("\u6b64\u5e33\u865f\u6c92\u6709\u5efa\u7acb\u8cc7\u6599\u7684\u6b0a\u9650\uff01"):a.status==706?alert("\u55ae\u4e00\u5e33\u865f\u50c5\u53ef\u8f38\u5165\u55ae\u7b46\u8cc7\u6599\uff0c\u6b64\u5e33\u865f\u5df2\u8f38\u5165\u904e\u8cc7\u6599\uff01"):alert("\u5efa\u7acb\u8cc7\u6599\u5931\u6557\uff01("+a.status+")");
i=!1;c.removeClass("disabled")},success:function(a){i=!1;c.removeClass("disabled");a=a.id;D==1?o(a):(alert(B>0?"\u4fee\u6539\u8cc7\u6599\u5b8c\u6210!":"\u5efa\u7acb\u8cc7\u6599\u5b8c\u6210!"),window.location.reload())}})}},q=function(){var c=a.find("a[href$='#savetemp']").parent("li");if(!c.hasClass("disabled")&&!i){if(check_file_is_uploading())return alert("\u6a94\u6848\u6b63\u5728\u4e0a\u50b3\u4e2d\uff0c\u8acb\u7b49\u5f85\u4e0a\u50b3\u5b8c\u6210!"),!1;if(!check_file_is_complete())return alert("\u6a94\u6848\u4e0a\u50b3\u672a\u5b8c\u6210\uff0c\u8acb\u91cd\u65b0\u4e0a\u50b3\u6a94\u6848!"),
!1;var d=g_storage.get(m),e=get_user_input_array_result(a.find(".body"));i=!0;var g=get_api_url("hr.item.temp.create"),f={};f.auth=v;f.token=r?"db_step_access_token":d;f.hid=h;f.data=JSON.stringify(e);f.upload_column=gen_upload_value();if(E>0)g=get_api_url("hr.item.temp.update"),f.hitid=E;c.addClass("disabled");b.ajax({url:g,data:f,type:"POST",dataType:"json",timeout:2E4,error:function(a){a.status==701?alert("\u6c92\u6709\u586b\u5beb\u552f\u4e00\u6b04\u4f4d\u5167\u5bb9\uff01"):a.status==702?alert("\u8cc7\u6599\u5df2\u7d93\u5b58\u5728\uff01"):
a.status==704?alert("\u6b64\u5e33\u865f\u6c92\u6709\u5efa\u7acb\u8cc7\u6599\u7684\u6b0a\u9650\uff01"):a.status==706?alert("\u55ae\u4e00\u5e33\u865f\u50c5\u53ef\u8f38\u5165\u55ae\u7b46\u8cc7\u6599\uff0c\u6b64\u5e33\u865f\u5df2\u8f38\u5165\u904e\u8cc7\u6599\uff01"):alert("\u66ab\u5b58\u8cc7\u6599\u5931\u6557\uff01("+a.status+")");i=!1;btn_finish.removeClass("disabled")},success:function(){i=!1;alert(E>0?"\u4fee\u6539\u66ab\u5b58\u8cc7\u6599\u5b8c\u6210!":"\u66ab\u5b58\u8cc7\u6599\u5b8c\u6210!");window.location.reload()}})}},
V=function(a,c){var d=get_api_url("hr.item.temp.get"),e={};e.auth=v;e.token=a;e.hid=h;b.ajax({url:d,data:e,type:"POST",dataType:"json",timeout:2E4,error:function(){c&&c(-1)},success:function(a){c&&c(a.id)}})},g=function(a,c){var d=get_api_url("hr.permission.get"),e={};e.auth=v;e.hid=h;e.token=a;b.ajax({url:d,data:e,type:"POST",dataType:"json",timeout:2E4,error:function(){L()},success:function(b){S=b.level;J(a,c)}})},J=function(d,f){var g=get_api_url("userinfo.get"),h={};h.auth=v;h.token=d;b.ajax({url:g,
data:h,type:"POST",dataType:"json",timeout:2E4,error:function(){r?(a.find(".readme").hide(),a.find(".signup-column").removeClass("signup-column-hidden"),a.find(".signup-column").removeClass("signup-column-disabled"),a.find("a[href='#savetemp']").parents("li").hide(),F=setInterval(function(){I();Q()},500),M("",function(){init_reviewer("");init_uploader(a.find(".body"))})):L()},success:function(b){a.find("#person_name").html(b.name);a.find("#option_logout").show();a.find(".login-x").hide();a.find(".signup-column").removeClass("signup-column-hidden");
a.find(".signup-column").removeClass("signup-column-disabled");a.find(".signup-column").attr("data-token",p);F=setInterval(function(){I();Q()},500);V(p,function(b){E=b;M(p,function(){init_reviewer(d);init_uploader(a.find(".body"))})});f&&f(b);c.complete!=null&&c.complete(e)}})},N=function(a,c){var d=b("#input_"+a),e="<input ",f=d.prop("attributes");typeof f!="undefined"&&(b.each(f,function(){this.name.indexOf("data-")==0?e+=this.name+"='"+this.value+"' ":this.name.indexOf("class")==0?e+="class='user_input' ":
this.name.indexOf("id")==0?e+="id='input_"+a+"' ":this.name.indexOf("name")==0&&(e+="id='input_"+a+"' ")}),e+=" value='",e+=encodeURIComponent(c),e+="' type='hidden'>",d.replaceWith(e))},M=function(c,d){var e=get_api_url("hr.item.input.data.get"),f={};f.auth=v;f.token=c;f.hid=h;f.hiid=B;f.copy_hiid=G;f.related_hid=A;f.query_latest_one=r?0:G==-1?1:0;f.temp=E;b.ajax({url:e,data:f,type:"POST",dataType:"json",timeout:2E4,error:function(){d&&d(json_data)},success:function(c){var e=c[0].data,f=c[0].resource_path,
g=c[0].one_data_per_account,h=c[0].data_list_count,m=c[0].editable,l=c[0].latest_update_time,j=c[0].archive;B=c[0].hr_item_id;log("load_data: hr_item_id="+B);B==-1&&!r?(a.find("#option_log_list").hide(),a.find("a[href='#savetemp']").parents("li").show(),a.find("a[href='#savetemp']").parents("li").addClass("disabled")):(a.find("#option_log_list").show(),a.find("a[href='#savetemp']").parents("li").hide());h>=1&&!g==0&&x!=1&&j==0&&(a.find("#option_data_list").show(),x==2?(a.find("#option_data_list_sec1").hide(),
a.find("#option_data_list_sec2").show()):x==3&&(a.find("#option_data_list_sec1").show(),a.find("#option_data_list_sec2").hide()));for(g=0;g<e.length;g++){var i=e[g].type,h=e[g].name,k=decode_uri_string(e[g].value),p=e[g].subitem,j=e[g].disabled;if(i=="single-select")for(i=0;i<p.length;i++){var k=p[i].name,n=p[i].value,o=p[i].editable;o==1&&(o=n.split(","),n=o[0],subitem_input_value=o.length>1?decodeURIComponent(o[1]):"",a.find("#"+h+" #input_subitem_"+k).val(subitem_input_value),a.find("#"+h+" #input_subitem_"+
k).prop("readonly",j));a.find("#"+h+" #input_"+k).prop("checked",n=="true"?!0:!1);a.find("#"+h+" #input_"+k).prop("disabled",j)}else if(i=="multi-select")for(i=0;i<p.length;i++)k=p[i].name,n=p[i].value,o=p[i].editable,o==1&&(o=n.split(","),n=o[0],subitem_input_value=o.length>1?decodeURIComponent(o[1]):"",a.find("#"+h+" #input_subitem_"+k).val(subitem_input_value),a.find("#"+h+" #input_subitem_"+k).prop("readonly",j)),a.find("#input_"+h+"[data-id='"+k+"']").prop("checked",n=="true"?!0:!1),a.find("#input_"+
h+"[data-id='"+k+"']").prop("disabled",j);else if(i=="combobox"){for(i=0;i<p.length;i++)if(k=p[i].name,n=p[i].value,o=decodeURIComponent(p[i].title),n=="true"){a.find("#input_"+h).val(o);break}a.find("#input_"+h).prop("disabled",j)}else if(i=="date_between"||i=="datetime_between")a.find("#input_"+h+"_start").prop("disabled",j),a.find("#input_"+h+"_end").prop("disabled",j),k!=""&&(o=k.split(","),a.find("#input_"+h+"_start").val(o[0]),a.find("#input_"+h+"_end").val(o[1]));else if(i=="associated-menu"){for(i=
0;i<p.length;i++)k=p[i].name,n=p[i].value,o=p[i].parent,n=="true"&&(n=o=="root_menu"?h:o,a.find("#subitem_input_"+n+" option[data-id='"+k+"']").prop("selected",!0),change_associated_option(h,n));a.find("#"+h+" .user_subitem_input").prop("disabled",j)}else if(i=="upload"){o="list";if(e[g].upload_setting!="undefined"&&(i=decodeURIComponent(e[g].upload_setting),i=b.parseJSON("["+i+"]"),typeof i[0]!="undefined"&&typeof i[0].listview!=="undefined"))o=i[0].listview;a.find("#input_"+h).prop("data-disable-upload",
j);a.find("#list_"+h).empty();if(k!=""){k=parse_json_string(k);for(i=0;k!=null&&i<k.length;i++){var p=(new Date).getTime()*(Math.floor(Math.random()*1E3)+1),s=k[i].file,q=f+"/"+h+"/"+s,n="";n+='<li class="qq-upload-success '+o+'" id="'+p+'">';n+='<a href="';n+=q;n+='" target="_blank">';if(o=="thumb"){var t=/[.]/.exec(s)?String(/[^.]+$/.exec(s)).toLowerCase():void 0;n+='<div class="fileDiv qq-upload-file"';n+=' id="'+t+'"';n+=' data-uid="'+p+'"';n+=' data-filename="'+s+'"';n+=' title="'+s+'"';n+=">";
n+='<span class="fileNameDiv">';n+=s;n+="</span>";if(t=="jpg"||t=="jpeg"||t=="png"||t=="gif")n+='<img class="qq-upload-thumb "',n+=' alt="'+s+'"',n+=' src="'+q+'">';n+="</div>"}else n+='<span class="qq-upload-file" data-uid="'+p+'" data-filename="'+s+'">',n+=s,n+="</span>";n+="</a>";j||(n+='<a class="qq-upload-remove" href="#" onclick="removeattach('+p+');">\u79fb\u9664</a>');n+="</li>";a.find("#list_"+h).append(n)}}}else if(i=="url"){o=[];if(k!="")try{o=JSON.parse(k)}catch(w){o=[]}a.find("#list_"+
h).empty();for(i=0;i<o.length;i++)p=o[i].uid,s=o[i].name,q=o[i].url,n="",n+='<li class="url-field" id="'+p+'">',n+='<a href="',n+=q,n+='" target="_blank">',n+=s,n+="</a>",j||(n+='<a class="qq-url-edit" href="javascript:void(0);" onclick="do_edit_url(\''+h+"', '"+p+"')\";>\u7de8\u8f2f</a>",n+='<a class="qq-url-remove" href="javascript:void(0);" onclick="do_remove_url(\''+h+"', '"+p+"')\";>\u79fb\u9664</a>"),n+="</li>",a.find("#list_"+h).append(n);a.find("#input_"+h).val(k);j==!0&&a.find("#input_add_url_"+
h).addClass("disabled")}else if(i=="table"){i=e[g].table_attr;k=parseInt(i.col);n=parseInt(i.row);o=i.type;if(i.row_type=="dynamic"){s="input_"+h;for(q=2;q<n+1;q++){t="<tr>";for(i=0;i<k;i++){var y="table_pos_"+h+"_"+q+"x"+i;t+="<td>";t+="<input id='"+y+"' class='fieldInput";o=="number"&&(t+=" numInput");t+="' value=''";t+="</td>"}t+="</tr>";a.find("#"+s+" tr:last").after(t)}a.find("#"+s).prop("data-table_row",n)}if(p!=null)for(i=0;i<p.length;i++)k=p[i].name,o=decodeURIComponent(p[i].title),a.find("#"+
k).val(o);a.find("#"+h+" .fieldInput").prop("readonly",j);a.find("#"+h+" .fieldInput").prop("disabled",j)}else i=="general-database"?(i=e[g].show_value,i!=""&&a.find("#input_select_db_data_"+h).text(i),a.find("#input_"+h).val(k),j==!0&&(a.find("#input_select_db_data_"+h).addClass("disabled"),a.find("#input_delete_db_data_"+h).hide()),k==""&&a.find("#input_delete_db_data_"+h).hide()):i=="reviewer"?(i=e[g].show_value,i!=""&&a.find("#input_select_reviewer_"+h).text(i),a.find("#input_"+h).val(k),j==!0&&
a.find("#input_select_reviewer_"+h).addClass("disabled")):i=="multi-string"||i=="text-editor"?(j?(N(h,k),a.find("#input_"+h).before(k)):a.find("#input_"+h).val(k),a.find("#input_"+h).prop("disabled",j),a.find("#input_"+h).prop("readonly",j)):i=="textblock"?(a.find("#input_"+h).prop("checked",k=="true"?!0:!1),a.find("#input_"+h).prop("disabled",j)):i=="computation"?(j=e[g].computation_attr,typeof j!="undefined"&&parseInt(j.manual_user_input)==1&&b("#chk_enable_manual_input_"+h).prop("checked",!0),
b("#"+h).find("#input_"+h).val(k)):a.find("#input_"+h).val(k)}a.find("#latest_update_time").text(l);O=m==1?!0:!1;a.find("#db_step_main").steps("setStep",0);a.find(".user_input").focusout(function(){a.find("#message_box").hide()});a.find(".user_input").keyup(function(){var c=b(this).attr("maxlength");b(this).attr("data-type");var d=b(this);if(typeof c!="undefined"){var e=d.position().left+50,d=d.position().top-50;log("show message_box left="+e+", top="+d);var f=b(this).val().length;a.find("#message_box").html("\u8f38\u5165\u5b57\u6578 : "+
f+" / "+c);a.find("#message_box").css("left",e);a.find("#message_box").css("top",d);a.find("#message_box").show()}O&&a.find("a[href='#savetemp']").parents("li").removeClass("disabled")});a.find(".user_input").change(function(){var c=b(this).attr("data-id");update_default_value(null,c,B<=0?!0:!1);O&&a.find("a[href='#savetemp']").parents("li").removeClass("disabled")});a.find(".user_input input").change(function(){var c=b(this).attr("data-id");update_default_value(null,c,B<=0?!0:!1);O&&a.find("a[href='#savetemp']").parents("li").removeClass("disabled")});
addEnableComputationManualInputEventListener();d&&d(c)}})},H=function(){var c=g_storage.get(m),d=get_api_url("hr.item.display.create"),e=get_user_input_xml_result(a.find(".body")),f={};f.auth=v;f.token=r?"db_step_access_token":c;f.hid=h;f.data=e;f.template=s;b.ajax({url:d,data:f,type:"POST",dataType:"json",timeout:2E4,error:function(a){alert("\u53d6\u5f97\u8cc7\u6599\u5931\u6557\uff01("+a.status+")")},success:function(b){a.find(".confirm-x #section_confirm #fcontent").html(b.data);a.find(".confirm-x").show()}})},
o=function(c){var d=g_storage.get(m),e=get_api_url("hr.item.display.create"),f={};f.auth=v;f.token=r?"db_step_access_token":d;f.hid=h;f.hiid=c;f.template=t;b.ajax({url:e,data:f,type:"POST",dataType:"json",timeout:2E4,error:function(a){alert("\u53d6\u5f97\u8cc7\u6599\u5931\u6557\uff01("+a.status+")")},success:function(b){a.find(".finish-x #section_finish #fcontent").html(b.data);a.find(".finish-x").show()}})};if(d=="onLoginHandler"){if(!b.isReady)return alert("widget is not ready!"),this;p=typeof j==
"undefined"?"":j;log("setToken: "+p+" and start to query person info");g(p,function(){p!=""&&(log(m+" = "+p),g_storage.set(m,p));window.location.reload()});return this}a.find("#db_step_main").steps({headerTag:"h3",bodyTag:"section",transitionEffect:"fade",autoFocus:!0,enableAllSteps:l,enablePagination:!0,enableSaveTempButton:!0,stepsOrientation:n,labels:{cancel:"Cancel",current:"current step:",pagination:"Pagination",finish:"\u5b8c\u6210",next:"\u4e0b\u4e00\u6b65",previous:"\u4e0a\u4e00\u6b65",loading:"Loading ...",
savetemp:"\u66ab\u5b58"},onStepChanging:function(b,c,d){return c>d?!0:check_user_input(a.find("section.current"))},onStepChanged:function(b,c){k=0;setTimeout(Q,1E3);z==c+1&&(O?a.find("a[href='#finish']").parents("li").show():a.find("a[href='#finish']").parents("li").hide());return!0},onFinishing:function(){return check_user_input(a.find("section.current"))},onFinished:function(){return y==1?(H(),!1):R()},saveTemp:function(){return q()}});a.find("#btn_login_w").click(function(){var a=f+"config/login.php",
b=encodeURI("hid="+h),a=a+"?response_type="+(v=="token"?"token":"session")+"&client_id="+u+"&permission_scope=hr&scope=userinfo.get,hr.item.create,hr.items.get,hr.item.set,hr.item.get,hr.reviewer.get,hr.item.display.create,hr.items.related.value.get,hr.permission.get,hr.item.input.data.get,hr.item.update,hr.item.temp.get,hr.item.temp.create,hr.item.temp.update&data="+b+"&continue="+encodeURIComponent(f+"public/open_id/callback.html?callback=onWidgetLoginSuccess&uid="+e);window.open(a,"mywindow","menubar=1,resizable=1,width=630,height=630, top=100, left=300")});
a.find("#btn_logout").click(function(){clearInterval(F);if(v=="token")g_storage.set(m,""),window.location.reload();else{var a=get_api_url("user.logout"),c={};c.auth=v;b.post(a,c,function(){window.location.reload()})}});a.find("#btn_ok_confirm").click(function(){a.find(".confirm-x").hide();R()});a.find("#btn_cancel_confirm").click(function(){a.find(".confirm-x").hide()});a.find("#btn_close_finish").click(function(){a.find(".finish-x").hide();window.location.reload()});a.find("#data_list").click(function(){w.data("action",
"").dialog("open")});a.find("#copy_data_list").click(function(){w.data("action","create_copy").dialog("open")});w=a.find("#dialog_data_list").dialog({autoOpen:!1,width:Math.min(b(window).width()-50,800),modal:!0,position:["middle",5],open:function(){var c=b(this).data("action"),d=g_storage.get(m),f=get_api_url("hr.items.get"),g={};g.hid=h;g.pageNum=0;g.maxRows=10;g.uid=e;g.shown_column=C;g.auth=v;g.token=d;g.field="hr_item_date";g.order="DESC";b.ajax({url:f,data:g,type:"POST",dataType:"json",timeout:2E4,
error:function(){w.dialog("close")},success:function(e){if(e.length<=0)w.dialog("close");else{var f=e[0].field_array,g="";g+=c=="create_copy"?'<p style="font-size:14px">\u4ee5\u4e0b\u662f\u60a8\u586b\u5beb\u904e\u5171'+(e.length-1)+"\u7b46\u8cc7\u6599\uff0c\u8acb\u9078\u53d6\u8981\u8f09\u5165\u7684\u526f\u672c\u8cc7\u6599:</p>":'<p style="font-size:14px">\u4ee5\u4e0b\u662f\u60a8\u586b\u5beb\u904e\u5171'+(e.length-1)+"\u7b46\u8cc7\u6599\uff0c\u8acb\u9078\u53d6\u4fee\u6539\u8cc7\u6599\u6216\u95dc\u9589\u8996\u7a97\u586b\u5beb\u65b0\u8cc7\u6599:</p>";
g+='<table border="1" cellpadding="5" cellspacing="1" style="width:100%;border-collapse: collapse;">';g+='<tr style="background-color:#ccc">';g+='<td><div style="width:35px">\u9078\u53d6</div></td>';g+="<td>\u7de8\u865f</td>";for(var h=0;h<f.length;h++)g+="<td>"+f[h].title+"</td>";g+="<td>\u5efa\u7acb\u6642\u9593</td>";g+="</tr>";for(h=1;h<e.length;h++)if(f=e[h].fields,typeof f!="undefined"){g+="<tr";B==e[h].id&&c!="create_copy"&&(g+=' style="background-color:#b0dde7"');g+=">";g+="<td>";g+=B==e[h].id&&
c!="create_copy"?"\u5df2\u9078":c=="create_copy"?'<a class="open-copy-data-list" href="javascript:void(0)" data-id="'+e[h].id+'" style="cursor:pointer;color:#0000FF">\u9078\u53d6</a>':'<a class="open-data-list" href="javascript:void(0)" data-id="'+e[h].id+'" style="cursor:pointer;color:#0000FF">\u9078\u53d6</a>';g+="</td>";g+="<td>";g+=e[h].id;g+="</td>";for(var i=0;i<f.length;i++){g+="<td>";for(var j=0;j<f[i].infos.length;j++)g+=decodeURIComponent(f[i].infos[j].show);g+="</td>"}g+="<td>";g+=e[h].date;
g+="</td>";g+="</tr>"}g+="</table>";b("#dialog_data_list").empty();b("#dialog_data_list").html(g);b(".open-data-list").click(function(){G=-1;B=b(this).attr("data-id");M(d,function(){init_reviewer(d);init_uploader(a.find(".body"));w.dialog("close")})});b(".open-copy-data-list").click(function(){G=b(this).attr("data-id");B=-1;M(d,function(){init_reviewer(d);init_uploader(a.find(".body"));w.dialog("close")})})}}})},buttons:{"\u95dc\u9589":function(){w.dialog("close")}},close:function(){}});a.resize(function(){var a=
g_storage.get(m);v=="token"&&a==""&&L();Q()});a.find("a[href='#savetemp']").parents("li").hide();a.find("#option_log_list").hide();a.find("#option_data_list").hide();attach_num_with_decimalinput_checker("numInput");init_datetime(a.find(".body"));init_text_editor(a.find(".body"),"");init_uploader(a.find(".body"));init_url_setting();g(p,null)}};b.fn.widget.countdown=function(a,c,d,e){var j=a.find("#countdown_main").attr("data-title"),f=parseInt(a.find("#countdown_main").attr("data-end-year")),g=parseInt(a.find("#countdown_main").attr("data-end-month")),
m=parseInt(a.find("#countdown_main").attr("data-end-day")),h=parseInt(a.find("#countdown_main").attr("data-end-hour")),n=parseInt(a.find("#countdown_main").attr("data-end-minute")),r=parseInt(a.find("#countdown_main").attr("data-show-day")),x=parseInt(a.find("#countdown_main").attr("data-show-hour")),s=parseInt(a.find("#countdown_main").attr("data-show-min")),y=parseInt(a.find("#countdown_main").attr("data-show-sec")),t=0;a.resize(function(){});t=setInterval(function(){var a="&#26178;",c="&#20998;",
d="&#31186;",z=new Date(f,g-1,m,h,n,0),l=function(a,b){var c=String(a);if(c)for(;c.length<b;)c="0"+c;return c};today=new Date;myMsec=z.getTime()-today.getTime();time0=Math.floor(myMsec/864E5);myMsec-=time0*864E5;time1=Math.floor(myMsec/36E5);myMsec-=time1*36E5;time2=Math.floor(myMsec/6E4);myMsec-=time2*6E4;time3=Math.floor(myMsec/1E3);myMsec-=time3*1E3;time4=Math.floor(myMsec/10);var u=time0;"5"==2?a=c=d=time1=time2=time3=time4="":"5"==3?c=d=time2=time3=time4="":"5"==4?d=time3=time4="":"5"==5&&(time4=
"");time1=l(time1,2);time2=l(time2,2);time3=l(time3,2);time4=l(time4,2);myMsec=today.getTime()-z.getTime();time00=Math.floor(myMsec/864E5);myMsec-=time00*864E5;time01=Math.floor(myMsec/36E5);myMsec-=time01*36E5;time02=Math.floor(myMsec/6E4);myMsec-=time02*6E4;time03=Math.floor(myMsec/1E3);myMsec-=time03*1E3;time04=Math.floor(myMsec/10);"5"==2?time01=time02=time03=time04="":"5"==3?time02=time03=time04="":"5"==4?time03=time04="":"5"==5&&(time04="");time01=l(time01,2);time02=l(time02,2);time03=l(time03,
2);time04=l(time04,2);z=b("."+e+" #counter");z.empty();time0>=0?(l="",l+='<p class="count_display">',l+='<span class="title">'+j+"</span>",r==1&&(l+='<span class="time">'+u+"</span>",l+="&#22825;"),x==1&&(l+='<span class="time">'+time1+"</span>",l+=a),s==1&&(l+='<span class="time">'+time2+"</span>",l+=c),y==1&&(l+='<span class="time">'+time3+"</span>",l+=d),l+="</p>",z.append(l)):(l(time1,2),z.append('<p class="count_display">'),z.append('<span class="title">'+j+"</span>"),z.append('<span class="time">'+
f+"/"+l(g,2)+"/"+l(m,2)+" "+l(h,2)+":"+l(n,2)+"</span>"),z.append("<p>\u5012\u6578\u6642\u9593\u5df2\u7d50\u675f</p>"),z.append("</p>"),clearInterval(t))},10);c.complete!=null&&c.complete(e)};b.fn.widget.text_marquee=function(a,c,d,e){var d=c.root_path,j=parseInt(a.find("#abgne_marquee").attr("data-speed"));a.resize(function(){});var f=function(){function c(){A=!A;var a=d.position().top/f,a=(D?a-1+g.length:a+1)%g.length;d.animate({top:a*f},s,function(){a==g.length-1?d.css("top",g.length/2*f-f):a==
0&&d.css("top",g.length/2*f);A=!A});y=setTimeout(c,t)}var d=a.find("div#abgne_marquee ul"),e=a.find("div#abgne_marquee"),g=d.append(d.html()).children(),f=a.find("div#abgne_marquee").height()*-1,s=j,y,t=3E3+s,D=0,A=!1;d.css("top",g.length/2*f);d.css("width",e.width()-60);g.hover(function(){clearTimeout(y)},function(){y=setTimeout(c,t)});a.find("div#abgne_marquee .marquee_btn").unbind("click");a.find("div#abgne_marquee .marquee_btn").click(function(){A||(clearTimeout(y),D=b(this).attr("id")=="marquee_next_btn"?
0:1,c())});a.find("div#abgne_marquee .marquee_btn").unbind("keydown");a.find("div#abgne_marquee .marquee_btn").keydown(function(a){a.keyCode==13&&!A&&(clearTimeout(y),D=b(this).attr("id")=="marquee_next_btn"?0:1,c())});y=setTimeout(c,t)},g={};g.uid=e;b.ajax({url:d+"widget/text_marquee/news_query_json.php",data:g,type:"POST",dataType:"json",timeout:2E4,error:function(){alert("Error loading JSON data")},success:function(b){for(var d=0,g=0;g<b.length;g++){var j=b[g].link,x=b[g].content,s="";b[g].enablelink==
"1"?(s="<li><span>",s+='<a href="'+j+'" title="'+x+'" target="_blank" class="b-link tab-ctl-x">'+x+"</a>",s+="</span></li>"):s='<li><span title="'+x+'" class="b-link">'+x+"</span></li>";a.find("ul#marquee_ul").append(s);d++}d<=1&&(a.find("#marquee_next_btn").hide(),a.find("#marquee_prev_btn").hide());f();c.complete!=null&&c.complete(e)}})};b.fn.widget.resource_show=function(a,c,d,e){var j=c.root_path,f=c.action,g=a.find("#resource_show_main").attr("data-album-id"),m=a.find("#resource_show_main").attr("data-shown-column"),
h=a.find("#resource_show_main").attr("data-style"),n=a.find("#resource_show_main").attr("data-string-table"),r=null,x=g,s=!!parseInt(a.find("#resource_show_main").attr("data-view")),y=j;if(h!="")try{r=JSON.parse(decodeURIComponent(h))}catch(t){r=null}if(n!="")try{json_string_table=JSON.parse(decodeURIComponent(n))}catch(D){json_string_table=null}var A=function(b){b=b.attr("hid");a.find("#resource_show_main").attr("data-field",b);b=a.find("#resource_show_main").attr("data-order");a.find("#resource_show_main").attr("data-order",
b=="DESC"?"ASC":"DESC");b=a.find("#resource_show_main").attr("data-page-num");u(g,b)},C=function(b){g=b.attr("aid");a.find("#search .input").val("");u(g,0)},z=function(a){var b=a.attr("file"),a=a.attr("resource_id"),c="";if(a!=void 0&&a>0)c=y+"/openfid.php?id="+a;else if(b!=void 0&&b!="")c=y+"/open.php?file="+b;else return;window.open(c)},l=function(a){a=a.attr("data-page-num");u(g,a)},u=function(g,f){var h=a.find("#resource_show_main").attr("data-query-count"),i=a.find("#resource_show_main").attr("data-field"),
n=a.find("#resource_show_main").attr("data-order"),t=a.find("#search .input").val(),u={};u.aid=g;u.field=i;u.order=n;u.pageNum=f;u.maxRows=h;u.keyword=escape(t);u.queryall=1;u.auth_type="user";u.bid=d;b.ajax({url:j+"widget/resource_integration/resource_query_field.php",data:u,type:"GET",dataType:"json",timeout:2E4,error:function(){},success:function(f){var h=parseInt(f[0].rcode);y=f[0].resource_root_url;if(h==401)a.find("#resource_show_main").attr("data-login-album-id",g),f=j+"config/login.php",h=
encodeURI("type=folder,bid="+d+",aid="+g+",resource="+g),f=f+"?response_type=session&permission_scope=resource&data="+h+"&continue="+encodeURIComponent(j+"public/open_id/callback.html?callback=onWidgetLoginSuccess&uid="+e),window.open(f,"mywindow","menubar=1,resizable=1,width=630,height=630, top=100, left=300");else if(h==200&&(build_resource_view(a.find("#mainRegion"),s,g,x,m,f,json_string_table,C,z,A,l),r!=null))f=r.table_head_color,f!=""&&b("#atb thead tr").css("background-color",f),f=r.table_odd_color,
f!=""&&b("#atb tr.odd").css("background-color",f),f=r.table_even_color,f!=""&&b("#atb tr.even").css("background-color",f),f=r.table_font_size,f!=""&&b("#atb tr.tcontent").css("font-size",f);c.update_tabindex!=null&&c.update_tabindex(e);f=a.find("#search").height()+a.find("#resource_show_main").height()+20;setMainHeight(f)}})};if(f=="onLoginHandler"){if(!b.isReady)return alert("widget is not ready!"),this;g=parseInt(a.find("#resource_show_main").attr("data-login-album-id"));u(g,0);return this}a.find("#resource_show_main").mouseover(function(){b(this).find(".optionDiv").show()});
a.find("#resource_show_main").mouseleave(function(){b(this).find(".optionDiv").hide()});a.find("#search .button").click(function(){u(g,0)});a.find("#search .input").keyup(function(b){var c=a.find("#search .input").val();(b.which==13||b.which!=9&&c=="")&&u(g,0)});b.contextMenu({selector:"#resource_show_main .optionDiv",trigger:"left",callback:function(a){a=="thumbView"?(s=0,u(g,0)):a=="listView"&&(s=1,u(g,0))},items:{thumbView:{name:"\u7e2e\u5716\u6a21\u5f0f",icon:"thumb",disabled:function(){return s==
1?!1:!0}},listView:{name:"\u5217\u8868\u6a21\u5f0f",icon:"list",disabled:function(){return s==0?!1:!0}}}});u(g,0)}})(jQuery);var g_default_active_class_id="",g_window_width=0,g_rtime,g_timeout=!1,g_delta=200,g_count=0,g_storage=new myStorage,g_prev_hash_value="",g_hash_value="",g_pre_div_news_table_main_width=0,g_token="";
function loadembedpage(b,a,c,d){b="#"+b;a="#"+a;if($(".pagecontent").length){display_site_embed_pages();var b=$(b).find(a),b=b.find("div"),a=b.width(),d=Math.max($("#site_embed_pages").height(),600),e=c.indexOf("?");c+=e==-1?"?fw="+a:"&fw="+a;c+="&fh="+d;c=c.replace("page_map_main.php","page_map_main_v2.php");$.ajax({url:c,type:"post",dataType:"html",data:"",timeout:2E4,error:function(){alert("Fail to load content!")},success:function(a){$(".pagecontent").html(a)}})}else d==1&&$(b).children().css("display",
"none"),b=$(b).find(a),b.css("display","block"),b=b.find("iframe"),a=b.width(),d=b.height(),e=c.indexOf("?"),c+=e==-1?"?fw="+a:"&fw="+a,c+="&fh="+d,b.attr("src",c)}var Browser={Version:function(){var b=999;navigator.appVersion.indexOf("MSIE")!=-1&&(b=parseFloat(navigator.appVersion.split("MSIE")[1]));return b}};function setMainWidth(){$("#site_embed_pages").css("width","100%")}
function setMainHeight(b){var a=parseInt($(".sites-subpages-map").height());isNaN(a)||(b+=a);a=parseInt($(".contentArea").css("padding-top"));isNaN(a)||(b+=a);$("#site_embed_pages").css("height",b);$("#center-content").children("#main").css("height",b)}
function setWidgetHeight(b,a){if($("."+b).is(":visible")&&($("."+b).css("height",a),$("."+b).closest(".sites-subpages-map").length>0)){var c=a+$(".sites-subpages-map").height()+10;$("#site_embed_pages").css("height",c);$("#site_embed_pages #iFrm").length>0&&$("#site_embed_pages #iFrm").css("height",c)}}
function setWidgetHeight(b,a){if(typeof b.is!="undefined"&&b.is(":visible")&&(b.css("height",a),b.closest(".sites-subpages-map").length>0)){var c=a+$(".sites-subpages-map").height()+10;$("#site_embed_pages").css("height",c);$("#site_embed_pages #iFrm").length>0&&$("#site_embed_pages #iFrm").css("height",c)}}
function adjustSectionSize(b){log("adjustSectionSize...");var a=$("#center-content"),c=a.children("#main");g_window_width=$(window).width();var d=0,e=$(".widget-top-x").length,j=e-1,f=0;$(".widget-top-x").each(function(a){$(this).css("top",d);$(this).css("z-index",120);d+=$(this).height();f+=$(this).height();j>a&&$(this).css("box-shadow","none")});e>0&&$("#container").css("top",f);is_rwd_page()?($(".s1").css("width","100%"),$(".s1").css("height","auto"),$(".s1").css("overflow-y","hidden"),b&&(e=c.height(),
$("#site_embed_pages").attr("data-ini-height",e),b())):setTimeout(function(){var d=[],f=[];$(".s1").each(function(){for(var a=$(this).parent().attr("id"),b=!1,c=0;c<d.length;c++)if(d[c]==a){b=!0;break}$(this).width()>0&&(b==!1&&(d.push(a),f[a]=0),f[a]++)});for(var e=0;e<d.length;e++){var j=d[e];if(!(f[j]<=1)){var r=0;$("#"+j+" .s1").each(function(){var a=0,b=$(this).attr("id");$(this).children().each(function(){var c=$(this).attr("class");if(c!=void 0&&$(this).css("display")=="block"&&$(this).attr("id")!=
"popup"){var d=parseInt($(this).css("padding-top")),e=parseInt($(this).css("padding-bottom")),d=$(this).height()+d+e;a+=d;log(b+" > class_name="+c+"'s height="+d)}});r=Math.max(r,a)});log(j+"'s height="+r);$("#"+j+" .s1").css("height",r)}}$(".s3").each(function(){var a=$(this).parent();if(a){var b=a.height();$(this).prevAll("div").each(function(){b-=$(this).height()});$(this).css("height",b)}});e=parseFloat($("#container").css("width"));j=parseFloat($("#container").parent().css("width"));if(100*e/
j+"%"=="100%"){var x=a.width();a.children(".s1").each(function(){$(this).attr("id")!="main"&&(x-=$(this).width())});e=parseInt(c.css("border-left"));e>0&&(x-=e);c.animate({width:x},50,function(){})}b&&(e=c.height(),$("#site_embed_pages").attr("data-ini-height",e),b())},200)}
function xxadjustWidgetSize(){$(".widget-x").each(function(){if($(this).attr("id")=="xheader"){$(this).attr("class");var b=parseInt($(this).find("#header_pic").attr("data-widget-height")),a=parseInt($(this).find("#header_pic").attr("data-image-width")),c=a,d=b;$(this).width()<a?(c=$(this).width(),d=c*(b/a),$(this).find("#header_pic").css("background-size",c),$(this).css("height",d)):($(this).find("#header_pic").css("background-size","auto"),$(this).css("height",b))}})}
function log(b){console.log&&g_debug=="1"&&console.log(new Date+": "+b)}function decode_uri_string(b){if(b=="")return log("decode_uri_string input string is empty."),"";var a="";try{a=decodeURIComponent(b)}catch(c){log("decode_uri_string fail ["+b+"]"),a=b}return a}function parse_json_string(b){if(b=="")return log("parse_json_string input string is empty."),"";var a=null;try{a=$.parseJSON(b)}catch(c){return log("parse_json_string fail ["+b+"]"),null}return a}
function load_Site_News_Tab_Content(b,a){var c="";c+="uid="+a;c+="&nid="+b;$.ajax({url:"../../widget/site_news_tab/news_query_content.php",data:c,type:"GET",dataType:"xml",timeout:2E4,error:function(){},success:function(a){$(window).width();$(window).height();var b="";b+="<div class='bd'>";$("entry",a).each(function(){var a=$(this).find("content").text();b+=a});b+="</div>";close_popup_content();setTimeout(function(){popup_content("html","940px",b)},300)}})}
function close_popup_content(){$(".popup").bPopup().close()}
function popup_content(b,a,c){$(".popup .content").empty();var d,e;if(is_rwd_page()||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&screen.width<g_rwd_device_width)if(b=="url"){window.location=c;return}else $(".popup").addClass("mobile_popup"),d=$(window).width()-10,e=$(window).height()-50;else $(".popup").removeClass("mobile_popup"),d=$(window).width()-100,e=$(window).height()-100;a=parseInt(a);a=a>d?d:a;d=e;b=="url"?($(".popup").css("width",a),$(".popup").css("height",
d),$(".popup").bPopup({content:"iframe",contentContainer:".popup .content",loadUrl:c,positionStyle:"fixed",position:["auto",20],loadCallback:function(){var a=$(this).find("iframe");a.css("width",$(this).width()+"px");a.css("height",$(this).height()+"px");a.css("background","url()");a.attr("scrolling","yes");$(".popup iframe").focus()}},function(){})):(b=$(window).scrollTop()+20,$(c).appendTo($(".popup .content")),$(".popup").css("width",a),$(".popup").css("height","auto"),$(".popup").bPopup({follow:[!1,
!1],position:["auto",b]}))}var gIframeContentResizeFunc=void 0;function callIframeContentResizeFunc(b,a){typeof gIframeContentResizeFunc!="undefined"&&gIframeContentResizeFunc(b,a)}function getUrlVars(){for(var b=[],a,c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)a=c[d].split("="),b.push(a[0]),b[a[0]]=a[1];return b}
function getParameterByName(b,a){if(!a)a=window.location.href;var b=b.replace(/[\[\]]/g,"\\$&"),c=RegExp("[?&]"+b+"(=([^&#]*)|&|#|$)").exec(a);return!c?"":!c[2]?"":decodeURIComponent(c[2].replace(/\+/g," "))}
function xxprocess_hash_value(){var b=window.location.hash.toLowerCase();if(b=="")g_prev_hash_value!=""&&(g_prev_hash_value="",window.location.reload());else{g_prev_hash_value=b;var a="";b.indexOf("#c")==0&&(b=b.replace("#c",""),isNaN(b)||(a=g_root_path+"widget/main_menu/page_map_main_v2.php",a+="?id="+b,g_default_active_class_id=b));a!=""&&load_site_embed_pages_content()}}function process_hash_value(){g_hash_value=window.location.hash.toLowerCase()}
function getUrlParameter(b){var a=decodeURIComponent(window.location.search.substring(1)).split("&"),c,d;for(d=0;d<a.length;d++)if(c=a[d].split("="),c[0]===b)return c[1]===void 0?!0:c[1]}
function process_url_param(){var b=getUrlParameter("cid"),a=getUrlParameter("nid"),c="";isNaN(b)?g_home_class_id!=""&&!isNaN(g_home_class_id)?(c=g_root_path+"widget/main_menu/page_map_main_v2.php",c+="?id="+g_home_class_id,g_default_active_class_id=g_home_class_id):isNaN(a)||(c=g_root_path+"widget/main_menu/page_map_main_v2.php",c+="?id="+a):(c=g_root_path+"widget/main_menu/page_map_main_v2.php",c+="?id="+b,g_default_active_class_id=b);return c!=""?(load_site_embed_pages_content(),!0):!1}
function resizeend(){new Date-g_rtime<g_delta?setTimeout(resizeend,g_delta):(g_timeout=!1,g_window_width!=$(window).width()&&adjustSectionSize())}function isBrowser(b){return navigator.userAgent.toLowerCase().indexOf(b)!=-1?1:0}function logout(){$.ajax({url:"../../config/logout_m.php?continue=../publish_page/"+g_bid,error:function(){},success:function(){}})}function is_mobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:!1}
function is_rwd_page(){if(g_rwd==1)if(screen.width<g_rwd_device_width)return!0;else if($(window).width()<g_rwd_device_width)return!0;return!1}function show_mobile_nav_bar(b){b=$("."+b+" #mobile_main_menu_content2");b.hasClass("menu-silder")?b.hasClass("menu-unactive")?(b.addClass("menu-active"),b.removeClass("menu-unactive")):b.hasClass("menu-active")&&(b.addClass("menu-unactive"),b.removeClass("menu-active")):b.is(":visible")?b.hide():b.show()}function change_doc_title(){}
function load_site_embed_pages_content(){$("#site_embed_pages").resize(function(){var a=$("#site_embed_pages").width();g_pre_div_news_table_main_width!=a&&(g_pre_div_news_table_main_width=a,adjust_site_embed_pages_size())});display_site_embed_pages();var b=$("meta[itemprop=name]").attr("content");change_doc_title(b+" | "+$(".l_map").text());$('#site_embed_pages a[href^="#"]').bind("click.smoothscroll",function(a){var b=$(this).attr("id");if(!(b!=void 0&&(b.indexOf("C-")==0||b.indexOf("tab_header")==
0))){a.preventDefault();var d=this.hash,a=$(".contentArea "+d);a.length>0?$("html, body").stop().animate({scrollTop:a.offset().top-40},900,"swing",function(){window.location.hash=d}):log("\u7db2\u9801\u9328\u9ede["+d+"]\u4e0d\u5b58\u5728")}});adjust_site_embed_pages_size()}
function display_site_embed_pages(){is_rwd_page()&&($(".mobile-main-menu-content").hasClass("menu-silder")||$(".mobile-main-menu-content").hide(),$(".menubar").hide());var b=$("#center-content").height();$("#site_embed_pages").attr("data-ini-height")!=void 0&&(b=parseInt($("#site_embed_pages").attr("data-ini-height")));var a=$(".s1").height(),b=Math.max(b,a)-5;b<=0&&(b=600);$("#site_embed_pages").css("height",b);$("#center-content").children("#main").children(".widget-x").hide();$("#site_embed_pages").show();
$("#page_main_content").show()}
function adjust_site_embed_pages_size(){var b=$("#site_embed_pages").find("#div_news_table_main"),a=$("#site_embed_pages").width();is_rwd_page()&&(a=$(window).width());var c=parseInt(b.css("margin-left"));isNaN(c)||(a-=c);c=parseInt(b.css("margin-right"));isNaN(c)||(a-=c);b.css("width",a);$("#site_embed_pages").find("#div_news_table_1_topbanner_center").css("width",a-4);c=0;if($(".menubar").length>0&&$(".menubar").is(":visible")){var c=$(".menubar").width()+1,d=parseInt($(".menubar").css("margin-left"));isNaN(d)||
(c+=d);d=parseInt($(".menubar").css("margin-right"));isNaN(d)||(c+=d)}d=parseInt($("#page_main_content").css("padding-left"));isNaN(d)||(a-=d);d=parseInt($("#page_main_content").css("padding-right"));isNaN(d)||(a-=d);a-=c;$(".contentArea").css("width",a);$(".sites-subpages").css("width",a);setMainWidth(a);c=parseInt(b.css("margin-top"));a=parseInt(b.css("margin-bottom"));b=b.height()+c+a;setMainHeight(b)}
function on_load_site_embed_pages_iFrm_complete(b){document.getElementById("iFrm");b!=void 0&&($("#iFrm").css("height",b),$("#iFrm").css("min-height",b),adjust_site_embed_pages_size(),adjustSectionSize())}function onGetWidgetToken(b,a){g_token=b;$(".widget-x").each(function(){$(this).attr("class").indexOf(a)!=-1&&$(this).widget({action:"onLoginHandler",root_path:g_root_path},b)})}
function onWidgetLoginSuccess(b,a){$(".widget-x").each(function(){$(this).attr("class").indexOf(a)!=-1&&$(this).widget({action:"onLoginHandler",root_path:g_root_path},b)})}
$(document).ready(function(){if(g_disable_right_menu)document.oncontextmenu=function(){return!1};var b=g_storage.get("board-fontsize"),a=getParameterByName("fontsize");a!=""&&(b=a);b=="medium"?$("#layout").css("font-size","1.1em"):b=="large"&&$("#layout").css("font-size","1.2em");g_storage.set("board-fontsize",b);process_hash_value();process_url_param();g_count=0;var c=$(".widget-x").length;log("widget_x_count = "+c);$(".widget-x").each(function(){$(this).css("visibility","visible");$(this).widget({action:"",
root_path:g_root_path,complete:function(a){g_count++;log("g_count = "+g_count+"/"+c+" : "+a);adjustSectionSize();$("a").each(function(){$(this).addClass("tab-ctl-x")})},update_tabindex:function(){$(".tab-ctl-x").each(function(){$(this).attr("tabindex",0)})}})});is_rwd_page()&&($("#container").css("width","auto"),$("#container").css("overflow-x","hidden"),$("#container").css("overflow-y","hidden"));load_data();$("#gotop").keyup(function(a){a.which==13&&jQuery("html,body").animate({scrollTop:0},500)});
$("#gotop").click(function(){jQuery("html,body").animate({scrollTop:0},500)});$("#Accesskey_C").length>0?$("#gotocenter").focus(function(){$(this).animate({left:"10",top:"0"},"fast","linear",function(){})}).focusout(function(){$(this).animate({left:"10",top:"-999"},"fast","linear",function(){})}):$("#gotocenter").hide();$(window).scroll(function(){$(this).scrollTop()>300?$("#gotop").fadeIn("fast"):$("#gotop").fadeOut("fast")});$(window).resize(function(){g_rtime=new Date;g_timeout===!1&&(g_timeout=
!0,setTimeout(resizeend,g_delta))});$(document).click(function(){});$("#class_password_input #password_submit").click(function(){var a=$(this).attr("data-cid"),b=$(this).attr("data-uid"),c=$("#class_password_input #password_input").val(),f={};f.uid=b;f.cid=a;f.pwd=c;$.ajax({url:"../../widget/main_menu/password_input.php",type:"post",dataType:"text",data:f,timeout:2E4,error:function(){alert("\u9a57\u8b49\u5931\u6557\uff01")},success:function(a){a==200?window.location.reload():alert("\u9a57\u8b49\u5931\u6557\uff01")}})});
setTimeout(function(){var a=Math.max($("#center-content").position().top,0);a>$(window).height()*0.7&&!isNaN(g_default_active_class_id)&&!g_disable_mainmenu_auto_scroll&&(log("html, body scrollTop: "+a),jQuery("html,body").animate({scrollTop:a},200))},500);if(g_person_id>0&&g_person_name!=""){b=window.location.href;if(b.indexOf("%27")!=-1||b.indexOf("%22")!=-1)b=b.substring(0,b.indexOf("?"));a="Hi! "+g_person_name;g_debug==1&&(a+="("+g_person_id+", "+g_person_level+")");a+="<a href='"+g_root_path+
"config/logout_m.php?continue="+b+"'>\u767b\u51fa</a>";$("#login_info").empty();$("#login_info").append(a);$("#login_info").show()}});function onYouTubeIframeAPIReady(){$(".widget-x").each(function(){$(this).attr("id")=="youtube"&&$(this).widget({action:"onYouTubeIframeAPIReady",root_path:g_root_path})})};
