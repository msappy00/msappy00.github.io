<html lang="zh-tw">


<!-- Mirrored from www.sgash.cyc.edu.tw/ischool/public/resource_view/show.php?view=1&aid=83 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Sep 2023 00:53:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<title>健康飲食相關</title>
	<link rel="stylesheet" href="css_show/style.css" type="text/css" />
</head>
<script type="text/javascript" src="../jquery/latest/js/jquery.js"></script>
	<script type="text/javascript" src="../../widget/resource_integration/js/resource_view.min.js"></script>
<link rel="stylesheet" type="text/css" media="screen" href="../jquery/context-menu/jquery.contextMenu.css" />
<script type="text/javascript" src="../jquery/context-menu/jquery.contextMenu.js"></script>
<script type="text/javascript" src="../jquery/jqModal2.js"></script>
<link rel="stylesheet" type="text/css" media="screen" href="../../static/config/jqmWindow2.css" />
<script type="text/javascript">
	var g_list_view = parseInt("1");
	var bEnableLearningProcess = "0";
	var g_root_album_id = parseInt("83");
	var g_modal_url = "";
	var g_enable_debug = parseInt("0");
	var g_shown_column = "";
	var g_parent_height = parseInt("-1");
	var g_custom_style = "";
	var g_string_table = "%7B%22goto_first_page%22%3A%22%5Cu7b2c%5Cu4e00%5Cu9801%22%2C%22goto_prev_page%22%3A%22%5Cu524d%5Cu4e00%5Cu9801%22%2C%22goto_next_page%22%3A%22%5Cu4e0b%5Cu4e00%5Cu9801%22%2C%22goto_latest_page%22%3A%22%5Cu6700%5Cu5f8c%5Cu4e00%5Cu9801%22%2C%22goto_page%22%3A%22%5Cu524d%5Cu5f80%5Cu9801%5Cu9762%22%7D";
	var g_json_string_table = null;

	function closeJqmWindow(bFresh) {

		var $modalWindow = $('div#modalWindow');
		$modalWindow.jqmHide();
		//alert($("#album_id").val());
		if (bFresh == 1) {

			content_query_field($("#album_id2").val(), 0);
		}
		//else
		//	content_query_field($("#album_id").val());
	}

	/*
	function adjustLayout(){
		var div_table_height = $(window).height() - $("#search").height() - $(".navDiv").height() - 10;
		$("#div_table_1").css("height", div_table_height);
	}
	*/

	$(document).ready(function() {
		
		if (g_enable_debug == 0)
			document.oncontextmenu = function() {
				return false;
			};

		if (g_parent_height == -1) {
			// var frame_height = $('.CKE-resourcePlugin', window.parent.document).height();
			var frame_height = $(window).height();
			if (frame_height != null) {
				g_parent_height = frame_height;
			} else {
				g_parent_height = (g_parent_height == -1) ? $(document).height() : g_parent_height;
			}
		}

		if (g_string_table!="") {
			try{
				g_json_string_table = JSON.parse(decodeURIComponent(g_string_table));
			}
			catch(e){
				g_json_string_table = null;
			}
		}

		if ($("#search").length > 0) {
			g_parent_height = g_parent_height - $("#search").height();
		} else {
			g_parent_height = g_parent_height - 60;
		}

		$("a#thumb").click(function() {
			$("#pageNum").val(0);
			g_list_view = 0;
			content_query_field($("#album_id").val(), 0);
		});

		$("a#list").click(function() {
			$("#pageNum").val(0);
			g_list_view = 1;
			content_query_field($("#album_id").val(), 0);
		});

		if (typeof setContentHeight != 'undefined')
			setContentHeight($("#mainRegion").height());

		$("#div_table_1").mouseover(function() {
			$(".optionDiv").css("display", "block");
		});

		$("#div_table_1").mouseleave(function() {
			$(".optionDiv").css("display", "none");
		});

		$('#search .button').click(function() {
			var keyword = $("#search .input").val();
			$("#keyword").val(keyword);
			$("#pageNum").val(0);
			content_query_field($("#album_id").val(), 0);
		});

		$('#search .input').keyup(function() {
			var keyword = $("#search .input").val();
			$("#keyword").val(keyword);
			$("#pageNum").val(0);
			content_query_field($("#album_id").val(), 0);
		});
		
		var closeModal = function(hash) {
			var $modalWindow = $(hash.w);
			hash.o.remove();
			$modalWindow.hide();
		};

		var openInFrame = function(hash) {
			var $trigger = $(hash.t);
			var $modalWindow = $(hash.w);
			var $modalContainer = $('iframe', $modalWindow);
			var container_width = $(hash.c.container).width();
			var newWidth = 300;
			var newHeight = 190;

			$modalContainer.html('').attr('src', g_modal_url);

			var newLeft = (container_width - newWidth) / 2;
			var newTop = 0;

			$modalWindow.css({
				width: newWidth,
				height: newHeight,
				top: -newHeight,
				left: newLeft
			}).show().animate({
				width: newWidth,
				height: newHeight,
				top: newTop,
				left: newLeft
			}, 'fast');
		};

		$('#modalWindow').jqm({
			overlay: 70,
			modal: true,
			trigger: '.thickbox',
			target: '#jqmContent',
			container: '.jqmContainer',
			onHide: closeModal,
			onShow: openInFrame
		});

		$.contextMenu({
			selector: '.optionDiv',
			trigger: 'left',
			callback: function(key, options) {
				if (key == "thumbView") {
					$("#pageNum").val(0);
					g_list_view = 0;
					content_query_field($("#album_id").val(), 0);
				} else if (key == "listView") {
					$("#pageNum").val(0);
					g_list_view = 1;
					content_query_field($("#album_id").val(), 0);
				}
			},
			items: {
				"thumbView": {
					name: "縮圖模式",
					icon: "thumb",
					disabled: function() {
						return (g_list_view == 1) ? false : true;
					}
				},
				"listView": {
					name: "列表模式",
					icon: "list",
					disabled: function() {
						return (g_list_view == 0) ? false : true;
					}
				}
			}
		});

		content_query_field($("#album_id").val(), 0);
	});

	function onSortClickHandler(e) {
		var field = e.attr("hid");
		$("#field").val(field);

		var order = $("#order").val();
		order = (order == "DESC") ? "ASC" : "DESC";
		$("#order").val(order);

		var pageNum = $("#pageNum").val();
		content_query_field($("#album_id").val(), pageNum);
	}

	function onFileClickHandler(e) {

		var file = e.attr('file');
		var resource_id = e.attr('resource_id');
		var url = '';

		if (resource_id != undefined && resource_id > 0)
			url = "openfid5445.html?id=" + resource_id;
		else if (file != undefined && file != "")
			url = 'open92bd.html?file=' + file;
		else
			return;

		window.open(url);
	}

	function onFolderClickHandler(e) {

		var album_id = e.attr("aid");

		$("#pageNum").val(0);

		clear_search();

		content_query_field(album_id, 0);
	}

	function onNavClickHandler(e) {
		var album_id = $("#album_id").val();
		var pageNum = e.attr("data-page-num");

		$("#pageNum").val(pageNum);

		content_query_field(album_id, pageNum);
	}

	function onLogin() {
		var pageNum = $("#pageNum").val();
		content_query_field($("#album_id2").val(), pageNum);
	}

	function content_query_field(aid, pageNum) {

		var album_id = (aid != -1 && aid != undefined) ? aid : $("#album_id").val();
		var is_parent_album = ((album_id == g_root_album_id) ? true : false);

		count_query_count(is_parent_album);

		$("#pageNum").val(pageNum);

		var queryCount = $("#queryCount").val();
		var field = $("#field").val();
		var order = $("#order").val();
		var keyword = $("#keyword").val();

		var param = {};
		param.aid = album_id;
		param.field = field;
		param.order = order;
		param.pageNum = pageNum;
		param.maxRows = queryCount;
		param.keyword = escape(keyword);
		param.queryall = 1;
		param.auth_type = "user";
		param.bid = parseInt("33");

		$.ajax({
			url: 'https://www.sgash.cyc.edu.tw/ischool/widget/resource_integration/resource_query_field.php',
			data: param,
			type: 'GET',
			dataType: 'json',
			timeout: 20000,
			error: function() {
				//alert('Error loading JSON data');
			},
			success: function(json_data) {
				var rcode = parseInt(json_data[0].rcode);

				if (rcode == 401) {
					$("#album_id2").val(album_id);

					var data = encodeURIComponent("type=folder,bid=33,aid=" + album_id + ",resource=" + album_id);

					var returl = "../../config/callback1b61.html?callback=onLogin";
					var openurl = "../../config/logind41d.html?";
					openurl += "permission_scope=resource";
					openurl += "&data=" + data;
					openurl += "&continue=" + returl;
					window.open(openurl);
				} else if (rcode == 200) {
					$("#album_id").val(album_id);

					var json_data_style = null;
					if (g_custom_style!="") {
						try{
							json_data_style = JSON.parse(decodeURIComponent(g_custom_style));
						}
						catch(e){
							json_data_style = null;
						}
					}
					
					build_resource_view($("#mainRegion"),
						g_list_view,
						$("#album_id").val(),
						g_root_album_id,
						g_shown_column,
						json_data,
						g_json_string_table,
						onFolderClickHandler,
						onFileClickHandler,
						onSortClickHandler,
						onNavClickHandler);

					if (json_data_style!=null) {
						var table_header_color = json_data_style["table_head_color"];
						if (table_header_color!="") {
							$("#atb thead tr").css("background-color", table_header_color);
						}

						var table_odd_color = json_data_style["table_odd_color"];
						if (table_odd_color!="") {
							$("#atb tr.odd").css("background-color", table_odd_color);
						}

						var table_even_color = json_data_style["table_even_color"];
						if (table_even_color!="") {
							$("#atb tr.even").css("background-color", table_even_color);
						}

						var table_font_size = json_data_style["table_font_size"];
						if (table_font_size!="") {
							$("#atb tr.tcontent").css("font-size", table_font_size);
						}
					}
				}

				$(".tab-ctl-x").each(function(i) {
					$(this).attr('tabindex', 0);
				});

				adjustLayout();
			}
		});
	}

	function onCloseFileLink() {
		$("#filelink").css("display", "none");
	}

	function clear_search() {
		$('#search .input').val();
		$("#keyword").val("");
	}

	function count_query_count(is_parent_album) {
		var div_table_width = $("#mainRegion").width();
		var navDiv_height = 35;
		var div_table_height = 0;
		var queryCount = 0;
		var parent_album_id = $("#parent_album_id").val();

		div_table_height = g_parent_height - navDiv_height;

		if ($(".block_usermenu").length) {
			div_table_height -= $(".block_usermenu").height();
			div_table_height -= parseInt($(".block_usermenu").css("padding-top"));
		}

		//alert(is_parent_album);

		if (g_list_view) {
			var thead_height = 35;
			var tr_height = 45;
			queryCount = Math.floor((div_table_height - thead_height) / tr_height);

			if (!is_parent_album)
				queryCount -= 1; //- 回上一頁的高度
		} else {
			queryCount = (Math.floor(div_table_width / 112)) * (Math.floor(div_table_height / 160));

			if (!is_parent_album)
				queryCount -= 1; //- 回上一頁的高度
		}

		$("#queryCount").val(Math.max(queryCount, 1));

		//alert(is_parent_album+", "+queryCount);
	}

	function adjustLayout() {
		var content_height = $("#search").height() + $("#div_table_1").height() + 10;

		if (inIframe() && parent.onLoadiFrmComplete && window.frameElement.id == "iFrm") {
			$("body").css("overflow", "hidden");
			parent.onLoadiFrmComplete(content_height);
		} else if (inIframe() && parent.on_load_site_embed_pages_iFrm_complete) {
			$("body").css("overflow", "hidden");
			parent.on_load_site_embed_pages_iFrm_complete(content_height);
		} else if (parent.setMainHeight) {
			parent.setMainHeight(content_height);
		}
	}

	function inIframe() {
		try {
			return window.self !== window.top;
		} catch (e) {
			return true;
		}
	}
</script>

<body>
	<h1 style="display:none">檔案列表</h1>
	<div class="jqmContainer">

		
					<div id="search">
				<label style="font-size:0em;" for="q">輸入關鍵字</label>
				<input class="input tab-ctl-x" type="text" id="q" name="q" size="31" style="margin: 2px;" placeholder="輸入關鍵字" alt="輸入關鍵字" title="輸入關鍵字">
				<input class="button tab-ctl-x" type="submit" name="sa" value="查詢" alt="查詢按鍵" title="查詢按鍵">
			</div>
		
		<div id="filelink" style="display:none; position:absolute; background:#FFF04D; width:200px; height:65px; border:1px solid #000000; padding:5px">
			<p style=" font-size:75%">請按下Ctrl+C複製以下檔案位置<a onClick="onCloseFileLink()" href="#">[關閉]</a></p>
			<label for="resourcefile"></label>
			<input id="resourcefile" name="resourcefile" type="text" value="" style="width:166px" alt="複製連結">
		</div>

		<div id="modalWindow" class="jqmWindow">
			<div id="jqmTitle">
				<span id="jqmTitleText">登入視窗</span>
			</div>
			<iframe id="jqmContent" src="#" frameborder="0" scrolling="no" title="登入視窗"> </iframe>
		</div>

		<div id="div_table_1">
			<input name="album_id" type="hidden" id="album_id" value="83">
			<input name="album_id2" type="hidden" id="album_id2" value="">
			<input name="parent_album_id" type="hidden" id="parent_album_id" value="-1">
			<input name="pageNum" type="hidden" id="pageNum" value="0">
			<input name="queryCount" type="hidden" id="queryCount" value="">
			<input name="flock" type="hidden" id="flock" value="">
			<input name="keyword" type="hidden" id="keyword" value="">
			<input name="field" type="hidden" id="field" value="">
			<input name="order" type="hidden" id="order" value="">
			<table width="100%" border="0" align="center" cellpadding="5" cellspacing="1">
				<tr>
					<td>
						<div id="mainRegion"></div>
					</td>
				</tr>
			</table>

			<span id="btnOption" class="optionDiv"></span>

		</div>
	</div>
</body>


<!-- Mirrored from www.sgash.cyc.edu.tw/ischool/public/resource_view/show.php?view=1&aid=83 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Sep 2023 00:53:24 GMT -->
</html>