$(document).ready(function(){if(g_disable_right_menu)document.oncontextmenu=function(){return!1};load()});function load(){var a=$("#main").width(),d=20;g_col_count>0?d=g_col_count:a<=800?d=5:a<=1260?d=10:a<=1720&&(d=15);g_slide_width=g_slide_height=(a-40)/d-4;query_photo()}
function query_photo(){var a={paction:"query_photo"};a.aid=g_album_id;a.pageNum=g_pageNum;a.maxRows=g_maxRows;a.ws_width=g_slide_width;a.ws_height=g_slide_height;a.d_order_field=g_d_order_field;a.d_order=g_d_order;$("#gallery-loading").show();$.ajax({url:"index.php",data:a,type:"POST",dataType:"json",timeout:2E4,error:function(){$(".gallerie-source").empty();$("#gallery-loading").hide();adjustLayout();alert("Fail to open album!")},success:function(a){for(var c=a[0].pageNum,g=a[0].totalPages,b="",
e=1;e<a.length;e++){var h=a[e].type,f=a[e].title,i=a[e].style,j=a[e].thumb_image;b+='<div class="slide_image" style="width:'+g_slide_width+"px;height:"+g_slide_height+'px">';h=="folder"?(h=get_album_url(a[e].album_id),b+='<a title="'+f+'" target="_self" class="tab-ctl-x" tabindex="0" data-type="folder" style="cursor:pointer"',b+=' href="'+h+'" target="_self"',b+=">",b+='<img border="0" src="'+j+'" title="'+f+'" style="'+i+'" alt="'+f+'"/>',b+='<img border="0" src="css/album.png" style="position:absolute;left:5px;top:5px;width:50px;height:50px;" alt="album icon">'):
(b+='<a href="'+(g_resource_url+"/openfid.php?id="+a[e].photo_id)+'" class="tab-ctl-x" tabindex="0" title="'+f+'" data-type="file">',b+='<img border="0" src="'+j+'" title="'+f+'" style="'+i+'" alt="'+f+'"/>');b+='<span class="slide_title"><span>'+f+"</span></span>";b+="</a>";b+="</div>"}$("#gallery-loading").hide();$(".gallerie-source").empty();$(".gallerie-source").append(b);$("#gallery").gallerie();$(".optionDiv").empty();$(".optionDiv").append(get_nav_div(c,g));adjustLayout()}})}
function adjustLayout(){var a=$("#main").height()+50;if(inIframe()&&parent.onLoadiFrmComplete&&window.frameElement.id=="iFrm")$("body").css("overflow","hidden"),parent.onLoadiFrmComplete(a);else if(inIframe()&&parent.on_load_site_embed_pages_iFrm_complete&&window.frameElement.id=="iFrm")parent.on_load_site_embed_pages_iFrm_complete(a);else a=$(window).height(),$("#main").css("height",a)}function inIframe(){try{return window.self!==window.top}catch(a){return!0}}
function get_nav_div(a,d){var c="";c+="<div class='navDiv'>";a>0?(c+="<a class='tab-ctl-x' title='\u7b2c\u4e00\u9801' tabindex='0' onclick='gotoPage(0)'>|&lt;</a>",c+="<a class='tab-ctl-x' title='\u4e0a\u4e00\u9801' tabindex='0' onclick='gotoPage("+(a-1)+")'>&lt;&lt;</a>"):c+="<span class='disable'>|&lt;</span><span class='disable'>&lt;&lt;</span>";for(var g=!1,b=0;b<d;b++)b==a?(c+="<span class='select'>"+(b+1)+"</span>",g=!1):Math.abs(b-a)>2&&b!=d-1&&b!=0&&d>10?g==!1&&(c+="<span>...</span>",g=!0):
c+="<a class='tab-ctl-x' title='\u7b2c"+(b+1)+"\u9801' tabindex='0' onclick='gotoPage("+b+")'>"+(b+1)+"</a>";a<d-1?(c+="<a class='tab-ctl-x' title='\u4e0b\u4e00\u9801' tabindex='0' onclick='gotoPage("+(a+1)+")'>&gt;&gt;</a>",c+="<a class='tab-ctl-x' title='\u6700\u5f8c\u4e00\u9801' tabindex='0' onclick='gotoPage("+(d-1)+")'>&gt;|</a>"):c+="<span class='disable'>&gt;&gt;</span><span class='disable'>&gt;&gt;|</span>";c+="</div>";return c}function gotoPage(a){g_pageNum=a;query_photo()}
function get_album_url(a){a="?aid="+a;a+="&style="+g_style;a+="&numThumbs="+g_numThumbs;a+="&col="+g_colCount;return a}$(window).resize(function(){load()});
