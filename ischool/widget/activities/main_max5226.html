<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>


<!-- Mirrored from www.sgash.cyc.edu.tw/ischool/widget/activities/main_max.php?bid=20&uid=WID_20_3_f2a449a7b33af778534df698142b0d5b4115723f by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Sep 2023 00:53:20 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link href='../../static/nav.css' type='text/css' rel='stylesheet' />
	<link href='../../static/loading_1.css' type='text/css' rel='stylesheet' />
	<script type="text/javascript" src="../../public/jquery/latest/js/jquery.js"></script>
	<style>
		.photo-main-album {
			min-height: 284px;
			position: relative;
			overflow: hidden;
			margin: 0px;
		}
		.album {
			width: 130px;
			float: left;
			overflow: hidden;
			padding: 5px;
		}

		.album-frame {
			width: 100%;
			height: 100%;
			margin: 0 auto;
			overflow: hidden;
		}

		.album-l {
			width: 100%;
			float: left;
		}

		.cover-img {
			position: relative;
			display: block;
			overflow: hidden;
			background: #c8cdd2;
			border: 1px #FFFFFF solid;
		}

		.album_title_block {
			position: absolute;
			display: block;
			bottom: 0px;
			left: 0px;
			width: 100%;
			height: 50px;
			color: #ffffff;
			background: #000000;
			overflow: hidden;
			word-wrap: break-word;
			opacity: 0.65;
			filter: alpha(opacity=75);
			font-family: 微軟正黑體, Arial, sans-serif;
			font-size: 0.8em;
			padding: 0;
			margin: 0;
		}

		/* .album_title_block div {
			padding: 2px;
			bottom: 0px;
			position: absolute;
			-webkit-transition: all 1.0s ease;
			transition: all 1.0s ease;
		} */

		.cover-img:hover .album_title_block {
			background: #FEF270;
			color: #000;
		}
	</style>
	<link href='../../publish_page/20/WID_20_3_f2a449a7b33af778534df698142b0d5b4115723f/layout.css' type='text/css' rel='stylesheet' />
	<script type="text/javascript">
		var g_root_path = "../../index.html";
		var g_per_slide_width = 0;
		var g_per_slide_height = 0;
		var g_default_row_count = parseInt("5");
		var g_show_album_datetime = !!parseInt("0");
		var g_show_album_visitors = !!parseInt("0");
		var g_show_nav_tags = !!parseInt("0");
		var g_filter_board_id = -1;
		var g_json_data = null;
		var g_unique_id = "WID_20_3_f2a449a7b33af778534df698142b0d5b4115723f";

		$(window).resize(function() {
			adjustSlideSize();
			build_table(g_json_data);
		});

		$(document).ready(function() {
			
			if (g_show_nav_tags) {
				$(".sort-panel-x").show();
			}
			else {
				$(".sort-panel-x").hide();
			}

			$(".nav-tag-x").click(function(){
				$(".nav-tag-x").removeClass("active");
				$(this).addClass("active");
				g_filter_board_id = $(this).attr("data-bid");
				query_field();
			});

			adjustSlideSize();
			query_field();
		});

		function query_field() {
			var param = {};

			param.paction = "query_album";
			param.uid = "WID_20_3_f2a449a7b33af778534df698142b0d5b4115723f";
			param.pageNum = parseInt($("#pageNum").val());
			param.maxRows = parseInt($("#queryCount").val());
			param.ws_width = g_per_slide_width;
			param.ws_height = g_per_slide_height;
			param.filter_board_id = g_filter_board_id;
			
			$(".pageLoading").show();
			
			$.ajax({
				url: 'main_max.php',
				data: param,
				type: 'POST',
				dataType: 'json',
				timeout: 20000,
				error: function() {
					$(".pageLoading").hide();
				},
				success: function(json_data) {
					g_json_data = json_data;
					build_table(g_json_data);
					$(".pageLoading").hide();
				}
			});
		}

		function build_table(json_data) {

			if (json_data==null) {
				return;
			}

			var html_album = "";
			var parent_alumb_id = -1;

			$(".photo-main-album").empty();

			var pageNum = json_data[0].pageNum;
			var totalPages = json_data[0].totalPages;

			for (var i = 1; i < json_data.length; i++) {
				html_album = "";

				var album_id = json_data[i].album_id;
				var album_title = json_data[i].album_title;
				var album_cover = json_data[i].album_cover;
				var album_date = json_data[i].album_date;
				var album_visitors = json_data[i].album_visitors;
				var thumb_image = json_data[i].thumb_image;
				var image_width = json_data[i].image_width;
				var image_height = json_data[i].image_height;
				var thumb_width = g_per_slide_width;
				var thumb_height = g_per_slide_height;
				var new_height = 0;
				var new_width = 0;
				var image_position = "";

				var return_url = window.location;
				var album_url = g_root_path + 'public/AlbumViewer/index.php?uid=' + g_unique_id;
				album_url += '&aid=' + album_id;
				album_url += '&col=' + g_default_row_count;
				album_url += '&maxRows=' + $("#queryCount").val();
				album_url += '&style=light';
				album_url += '&return=' + encodeURIComponent(return_url);

				new_height = thumb_height;
				new_width = new_height*(image_width/image_height);
				
				if(new_width<thumb_height){
					new_width = thumb_width;
					new_height = new_width*(image_height/image_width);
					image_position = "margin-top:" + ((thumb_height - new_height)/2) + "px;";
				}
				else
					image_position = "margin-left:" + ((thumb_width - new_width)/2) + "px;";
				
				thumb_style = "width:" + new_width + "px;";
				thumb_style += "height:" + new_height + "px;";
				thumb_style += image_position;

				// console.log(new_width+"X"+new_height+", "+image_width+"X"+image_height+", " + thumb_width + "X" + thumb_height);
				// console.log(thumb_style);

				html_album += '<a href="' + album_url + '" target="_self">';
				html_album += '<div class="album item album-thumb" id="' + album_id + '" style="width:' + g_per_slide_width + 'px;height:' + g_per_slide_height + 'px;">';
				html_album += '<div class="album-frame">';
				html_album += '<div class="album-l">';
				html_album += '<div class="album-lm">';
				html_album += '<div class="cover-img" id="ext-gen14" style="width:' + g_per_slide_width + 'px;height:' + g_per_slide_height + 'px;">';
				// html_album += '<a href="' + g_root_path + 'public/AlbumViewer/index.php?aid=' + album_id + '" target="_blank">';
				html_album += '<img class="photo-thumb-img" style="' + thumb_style + '" src="' + thumb_image + '" border="0">';
				// html_album += '</a>';
				html_album += '<div class="album_title_block" title="' + album_title + '">';
				if (g_show_album_datetime) {
					html_album += '<div class="info"><span class="date">' + album_date + '</span></div>';
				}
				
				html_album += '<div class="title">' + album_title + '</div>';
				
				if (g_show_album_visitors) {
					html_album += '<div class="info"><span class="visitors">瀏覽次數：' + album_visitors + '</span></div>';
				}
				
				html_album += '</div>';
				html_album += '</div>';
				html_album += '</div>';
				html_album += '</div>';
				html_album += '</div>';
				html_album += '</div>';
				html_album += '</a>';

				$(".photo-main-album").append(html_album);
			}

			$(".optionDiv").empty();
			$(".optionDiv").append(get_nav_div(parent_alumb_id, pageNum, totalPages));

			$(".album_title_block").each(function() {
				var w = $(this).width() - 24;
				$(this).find(".info").css("width", w);
				$(this).find(".title").css("width", w);
			});

			$(".album").mouseenter(function() {
				var _this_album_title_block = $(this).find(".album_title_block");

				$(".album_title_block").each(function() {
					$(this).removeClass("over-album-x");
				});

				_this_album_title_block.addClass("over-album-x");

				var target_height = $(this).height();
				_this_album_title_block.animate({
					top: 0,
					height: target_height
				}, 100, function() {
					$(".album_title_block").each(function() {
						if(!$(this).hasClass("over-album-x")) {
							$(this).css("top", "unset");
							$(this).css("height", 50);
							$(this).css("bottom", 0);
						}
					});
				});
			});
			
			$(".photo-main-album").mouseleave(function(){
				$(".album_title_block").each(function() {
					$(this).css("top", "unset");
					$(this).css("height", 50);
					$(this).css("bottom", 0);
				});
			});

			adjustLayoutHeight();
		}

		function get_nav_div(album_id, pageNum, totalPages) {
			var output = "";

			output += "<div class='navDiv'>";

			if (pageNum > 0) {
				output += "<a href='javascript:void(0);' title='第一頁' onclick='gotoPage(" + album_id + ", 0)'>|&lt;</a>";
				output += "<a href='javascript:void(0);' title='上一頁' onclick='gotoPage(" + album_id + ", " + (pageNum - 1) + ")'>&lt;&lt;</a>";
			} else {
				output += "<span class='disable'>|&lt;</span><span class='disable'>&lt;&lt;</span>";
			}

			var showSkipPage = false;
			for (var i = 0; i < totalPages; i++) {

				if (i == pageNum) {
					output += "<span class='select'>" + (i + 1) + "</span>";
					showSkipPage = false;
				} else {

					if (Math.abs(i - pageNum) > 2 && i != totalPages - 1 && i != 0 && totalPages > 10) {
						if (showSkipPage == false) {
							output += "<span>...</span>";
							showSkipPage = true;
						}
						continue;
					}

					output += "<a href='javascript:void(0);' title='第" + (i + 1) + "頁' onclick='gotoPage(" + album_id + ", " + i + ")'>" + (i + 1) + "</a>";
				}
			}

			if (pageNum < totalPages - 1) {
				output += "<a href='javascript:void(0);' title='下一頁' onclick='gotoPage(" + album_id + ", " + (pageNum + 1) + ")'>&gt;&gt;</a>";
				output += "<a href='javascript:void(0);' title='最後一頁' onclick='gotoPage(" + album_id + ", " + (totalPages - 1) + ")'>&gt;|</a>";
			} else {
				output += "<span class='disable'>&gt;&gt;</span><span class='disable'>&gt;&gt;|</span>";
			}

			output += "</div>";

			return output;
		}

		function gotoPage(album_id, pageNum) {
			$("#pageNum").val(pageNum);

			query_field();
		}

		function adjustLayoutHeight() {
			var main_height = $("#container").height() + 20;

			if (inIframe() && parent.onLoadiFrmComplete && window.frameElement.id == "iFrm") {
				parent.onLoadiFrmComplete(main_height);
				return;
			} else if (inIframe() && parent.on_load_site_embed_pages_iFrm_complete && window.frameElement.id == "iFrm") {
				parent.on_load_site_embed_pages_iFrm_complete(main_height);
				return;
			}

			//if(parent.setMainHeight){	
			//parent.setMainHeight(main_height);	
			//}
		}

		function inIframe() {
			try {
				return window.self !== window.top;
			} catch (e) {
				return true;
			}
		}

		function adjustSlideSize() {
			var main_width = $(".photo-main-album").width();
			var padding = 10;
			var row_count = 3;

			if (screen.width < 676)
				row_count = 1;
			else
				row_count = g_default_row_count;

			main_width = main_width - (row_count + 1) * padding;
			
			var album_size = Math.floor(main_width / row_count) - 2;
			g_per_slide_width = album_size;
			g_per_slide_height = album_size;
		}
	</script>

</head>

<body>
	<div id="container" class="WID_20_3_f2a449a7b33af778534df698142b0d5b4115723f">
		<input name="pageNum" type="hidden" id="pageNum" value="0">
		<input name="queryCount" type="hidden" id="queryCount" value="25">
		<div class="sort-panel-x">
			<ul class="nav nav-tags-x filter">
				<li class="nav-tag-x active" data-bid="-1"><a href="javascript:void(0);">所有相簿</a></li>
							</ul>
		</div>
		<div class="photo-main-album expand-album-mode-x">
		</div>
		<div id="btnOption" class="optionDiv"></div>
	</div>
	<div class="pageLoading">
		<div class="spinner">
			<div class="rect1"></div>
			<div class="rect2"></div>
			<div class="rect3"></div>
			<div class="rect4"></div>
			<div class="rect5"></div>
		</div>
	</div>
</body>


<!-- Mirrored from www.sgash.cyc.edu.tw/ischool/widget/activities/main_max.php?bid=20&uid=WID_20_3_f2a449a7b33af778534df698142b0d5b4115723f by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Sep 2023 00:53:21 GMT -->
</html>